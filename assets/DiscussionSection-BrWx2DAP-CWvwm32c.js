import{C as $,c as e,az as j,aA as q,aB as b}from"./index-DvRCDgMZ.js";const ee=({isDark:s,messages:o,onSend:h,showModeration:g,onDelete:c,onTogglePin:d})=>{const[x,p]=$.useState(""),m=()=>{x.trim()&&(h(x.trim()),p(""))};return e.jsxs("div",{children:[e.jsx("div",{className:"space-y-3 mb-4 max-h-72 overflow-y-auto pr-1",children:o.length===0?e.jsx("div",{className:"text-sm opacity-60 text-center py-4",children:"æš‚æ— æ¶ˆæ¯ï¼Œå¿«æ¥å‘ç¬¬ä¸€æ¡æ¶ˆæ¯å§ï¼"}):o.map(n=>e.jsx("div",{className:`p-3 rounded-xl ${s?"bg-gray-700":"bg-gray-100"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(q,{src:n.avatar,alt:n.user,size:"sm",className:"mr-3",variant:"heritage"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("div",{className:"text-sm font-medium",children:n.user})}),e.jsx("div",{className:"text-xs text-gray-400",children:n.createdAt?new Date(n.createdAt).toLocaleTimeString():""})]}),e.jsx("div",{className:`text-sm ${s?"text-gray-200":"text-gray-800"}`,children:n.text}),g&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>d==null?void 0:d(n.id),className:`${s?"bg-gray-800 text-white":"bg-white text-gray-800"} px-2 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-300"} transition-colors`,children:n.pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶"}),e.jsx("button",{onClick:()=>c==null?void 0:c(n.id),className:`${s?"bg-red-700 text-white":"bg-red-500 text-white"} px-2 py-1 rounded-lg text-xs transition-colors`,children:"åˆ é™¤"})]})]})]})},n.id))}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:x,onChange:n=>p(n.target.value),onKeyPress:n=>n.key==="Enter"&&m(),placeholder:"å‘è¡¨ä½ çš„çœ‹æ³•...",className:`flex-1 px-3 py-2 rounded-lg focus:outline-none focus:ring-2 ${s?"bg-gray-700 text-white ring-1 ring-gray-600 focus:ring-purple-500":"bg-white text-gray-900 ring-1 ring-gray-300 focus:ring-pink-300"}`}),e.jsx("button",{onClick:m,className:"px-3 py-2 rounded-lg bg-gradient-to-r from-red-600 to-pink-600 text-white transition-colors hover:opacity-90",children:"å‘é€"})]})]})},te=({isDark:s,threads:o,onThreadsChange:h,mode:g,selectedStyle:c,selectedTopic:d,newTitle:x,onNewTitleChange:p,newContent:m,onNewContentChange:n,threadSearch:S,onThreadSearchChange:J,threadSort:w,onThreadSortChange:A,favOnly:f,onFavOnlyChange:H,favoriteThreads:y,onFavoriteThreadsChange:M,replyText:v,onReplyTextChange:k,threadDraft:l,onThreadDraftChange:L,hotTopics:N,STYLE_LIST:P,TOPIC_LIST:E,onModeChange:T,onSelectedStyleChange:D,onSelectedTopicChange:_,onInsertRandomIdea:G,upvoteGuard:I,onUpvoteGuardChange:K})=>{const[C,B]=$.useState("");$.useEffect(()=>{const t=setTimeout(()=>{B(S.trim())},300);return()=>clearTimeout(t)},[S]);const F=()=>{const t=x.trim(),r=m.trim();if(!t||!r||["å¹¿å‘Š","è¿è§„"].some(u=>t.includes(u)||r.includes(u)))return;const a=[{id:`t-${Date.now()}`,title:t,content:r,createdAt:Date.now(),replies:[],topic:g==="style"?c:d,upvotes:0},...o];h(a),localStorage.setItem("jmzf_threads",JSON.stringify(a)),p(""),n(""),b.success("å¸–å­å·²å‘å¸ƒ")},R=()=>{l&&(p(l.title||""),n(l.content||""),l.mode&&(T(l.mode),l.mode==="style"&&l.selected&&D(l.selected),l.mode==="topic"&&l.selected&&_(l.selected)))},Y=()=>{L(null);try{localStorage.removeItem("jmzf_thread_draft")}catch{}},O=t=>{const r=(v[t]||"").trim();if(!r)return;const i=o.map(a=>a.id===t?{...a,replies:[...a.replies,{id:`r-${Date.now()}`,content:r,createdAt:Date.now()}]}:a);h(i),localStorage.setItem("jmzf_threads",JSON.stringify(i)),k({...v,[t]:""}),b.success("å›å¤å·²æ·»åŠ ")},U=t=>{if(I[t]){b.info("å·²ç‚¹è¿‡èµ");return}const r=o.map(a=>a.id===t?{...a,upvotes:(a.upvotes||0)+1}:a);h(r),localStorage.setItem("jmzf_threads",JSON.stringify(r));const i={...I,[t]:!0};K(i),localStorage.setItem("jmzf_upvote_guard",JSON.stringify(i))},V=t=>{const r=y.includes(t)?y.filter(i=>i!==t):[t,...y];M(r)},W=t=>{const r=o.map(i=>i.id===t?{...i,pinned:!i.pinned}:i);h(r),localStorage.setItem("jmzf_threads",JSON.stringify(r)),b.success("ç½®é¡¶çŠ¶æ€å·²æ›´æ–°")},X=t=>{const r=o.filter(i=>i.id!==t);h(r),localStorage.setItem("jmzf_threads",JSON.stringify(r)),b.success("å¸–å­å·²åˆ é™¤")},Z=(t,r)=>{const i=o.map(a=>a.id===t?{...a,replies:a.replies.filter(u=>u.id!==r)}:a);h(i),localStorage.setItem("jmzf_threads",JSON.stringify(i)),b.success("å›å¤å·²åˆ é™¤")},z=$.useMemo(()=>o.filter(t=>g==="style"?t.topic===c:t.topic===d).filter(t=>f?y.includes(t.id):!0).filter(t=>C?t.title.includes(C)||t.content.includes(C):!0).sort((t,r)=>{const i=Number(r.pinned)-Number(t.pinned);return i!==0?i:w==="new"?r.createdAt-t.createdAt:w==="reply"?r.replies.length-t.replies.length:(r.upvotes||0)+r.replies.length-((t.upvotes||0)+t.replies.length)}),[o,g,c,d,f,y,C,w]);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`mb-6 rounded-2xl p-4 ${s?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"}`,children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-4",children:[e.jsx("span",{className:"text-sm opacity-70",children:"å­ç¤¾åŒºï¼š"}),e.jsx(j.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>T("style"),className:`${g==="style"?"bg-red-600 text-white":s?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm transition-colors hover:opacity-90`,children:"é£æ ¼"}),e.jsx(j.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>T("topic"),className:`${g==="topic"?"bg-red-600 text-white":s?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm transition-colors hover:opacity-90`,children:"é¢˜æ"})]}),g==="style"?e.jsx("div",{className:"flex flex-wrap gap-2",children:P.map(t=>{const r=o.filter(i=>i.topic===t).length;return e.jsxs(j.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>D(t),className:`${c===t?"bg-red-600 text-white":s?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm flex items-center gap-2 transition-colors hover:opacity-90`,children:[e.jsx("span",{children:t}),e.jsx("span",{className:`${c===t?"bg-white text-red-600 ring-1 ring-red-200":s?"bg-gray-600 text-white ring-1 ring-gray-700":"bg-gray-300 text-gray-900 ring-1 ring-gray-300"} text-xs px-2 py-0.5 rounded-full`,children:r})]},t)})}):e.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(t=>{const r=o.filter(i=>i.topic===t).length;return e.jsxs(j.button,{whileHover:{scale:1.03},whileTap:{scale:.97},onClick:()=>_(t),className:`${d===t?"bg-red-600 text-white":s?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-full text-sm flex items-center gap-2 transition-colors hover:opacity-90`,children:[e.jsx("span",{children:t}),e.jsx("span",{className:`${d===t?"bg-white text-red-600 ring-1 ring-red-200":s?"bg-gray-600 text-white ring-1 ring-gray-700":"bg-gray-300 text-gray-900 ring-1 ring-gray-300"} text-xs px-2 py-0.5 rounded-full`,children:r})]},t)})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:`rounded-2xl p-4 lg:col-span-1 ${s?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"}`,children:[e.jsx("div",{className:"font-medium mb-3",children:e.jsx("span",{className:"flex items-center gap-2",children:"ğŸ”¥ è¯é¢˜çƒ­æ¦œ"})}),e.jsxs("ul",{children:[N.map(([t,r],i)=>{const a=N.length?N[0][1]:1,u=Math.max(6,Math.round(r/Math.max(1,a)*100));return e.jsxs("li",{className:"py-1 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"mr-3",children:[i+1,". ",t]}),e.jsx("span",{className:"opacity-70",children:r})]}),e.jsx("div",{className:`${s?"bg-gray-700":"bg-gray-200"} w-full h-2 rounded-full mt-1`,children:e.jsx("div",{style:{width:`${u}%`},className:`h-2 rounded-full ${s?"bg-red-500":"bg-red-600"} transition-all duration-300`})})]},t)}),N.length===0&&e.jsx("li",{className:"text-sm opacity-60",children:"æš‚æ— æ•°æ®"})]})]}),e.jsxs("div",{className:`rounded-2xl p-4 lg:col-span-2 ${s?"bg-gray-800 ring-1 ring-gray-700 shadow-lg":"bg-white ring-1 ring-gray-200 shadow-lg"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"font-medium",children:[g==="style"?c:d," å­ç¤¾åŒºè®¨è®º"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{value:S,onChange:t=>J(t.target.value),className:`${s?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} px-3 py-1 rounded-lg border text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"æœç´¢è®¨è®º","aria-label":"æœç´¢è®¨è®º"}),e.jsxs("select",{value:w,onChange:t=>A(t.target.value),className:`${s?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} px-3 py-1 rounded-lg border text-sm focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,children:[e.jsx("option",{value:"new",children:"æœ€æ–°"}),e.jsx("option",{value:"reply",children:"æœ€å¤šå›å¤"}),e.jsx("option",{value:"hot",children:"çƒ­åº¦"})]}),e.jsx("button",{onClick:()=>H(!f),className:`${f?"bg-red-600 text-white":s?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-lg text-sm transition-colors`,children:f?"åªçœ‹æ”¶è—":"å…¨éƒ¨"}),e.jsx("button",{onClick:G,className:`${s?"bg-gray-700 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-lg text-sm transition-colors`,children:"éšæœºçµæ„Ÿ"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[e.jsx("input",{value:x,onChange:t=>p(t.target.value),className:`${s?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} px-3 py-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"å¸–å­æ ‡é¢˜ï¼ˆå¦‚ï¼šäº¬å‰§è§’è‰²è®¾è®¡æ‰“ç£¨å»ºè®®ï¼‰","aria-label":"å¸–å­æ ‡é¢˜"}),e.jsx("button",{onClick:F,disabled:!x.trim()||!m.trim(),"aria-disabled":!x.trim()||!m.trim(),className:`px-3 py-2 rounded-lg transition-colors ${!x.trim()||!m.trim()?s?"bg-gray-600 text-gray-300":"bg-gray-300 text-gray-600":"bg-red-600 text-white hover:bg-red-700 shadow-sm"}`,children:"å‘å¸ƒæ–°å¸–"})]}),l&&(l.title||l.content)&&e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:`${s?"text-gray-400":"text-gray-600"} text-xs`,children:"æ£€æµ‹åˆ°è‰ç¨¿ï¼Œå¯æ¢å¤ä¸Šä¸€ç¼–è¾‘"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:R,className:`${s?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-200"}`,children:"æ¢å¤è‰ç¨¿"}),e.jsx("button",{onClick:Y,className:`${s?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-200"}`,children:"æ¸…é™¤è‰ç¨¿"})]})]}),e.jsx("textarea",{value:m,onChange:t=>n(t.target.value),className:`${s?"bg-gray-700 text-white":"bg-gray-50 text-gray-900"} w-full h-24 px-3 py-2 rounded-lg border mb-4 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"è¯¦ç»†å†…å®¹"}),e.jsxs("div",{className:"space-y-3",children:[z.map(t=>e.jsxs(j.div,{whileHover:{y:-2},className:`${s?"bg-gray-700 ring-1 ring-gray-700":"bg-gray-50 ring-1 ring-gray-200"} rounded-xl p-4`,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"font-medium",children:[t.title,t.pinned&&e.jsx("span",{className:"ml-2 text-xs px-2 py-0.5 rounded-full bg-red-600 text-white",children:"ç½®é¡¶"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>U(t.id),"aria-label":"ç‚¹èµå¸–å­",className:"px-3 py-1 rounded-lg text-xs bg-red-600 text-white hover:bg-red-700 transition-colors",children:["ç‚¹èµ ",t.upvotes||0]}),e.jsx("button",{onClick:()=>V(t.id),"aria-label":"æ”¶è—å¸–å­",className:`${y.includes(t.id)?"bg-blue-600 text-white":s?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-200"} transition-colors`,children:y.includes(t.id)?"å·²æ”¶è—":"æ”¶è—"}),e.jsx("button",{onClick:()=>W(t.id),"aria-label":t.pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶",className:`${s?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-200"} transition-colors`,children:t.pinned?"å–æ¶ˆç½®é¡¶":"ç½®é¡¶"}),e.jsx("button",{onClick:()=>X(t.id),"aria-label":"åˆ é™¤å¸–å­",className:`${s?"bg-gray-800 text-white":"bg-white text-gray-900"} px-3 py-1 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-200"} transition-colors`,children:"åˆ é™¤"})]})]}),e.jsx("div",{className:`text-sm opacity-80 mt-1 ${s?"text-gray-300":"text-gray-700"}`,children:t.content}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("input",{value:v[t.id]||"",onChange:r=>k({...v,[t.id]:r.target.value}),onKeyDown:r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),O(t.id))},className:`${s?"bg-gray-800 text-white":"bg-white text-gray-900"} flex-1 px-3 py-1 rounded-lg border focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors`,placeholder:"å›å¤å†…å®¹","aria-label":"å›å¤å†…å®¹"}),e.jsx("button",{onClick:()=>O(t.id),"aria-label":"æ·»åŠ å›å¤",className:`${s?"bg-gray-800 text-white":"bg-gray-100 text-gray-900"} px-3 py-1 rounded-lg text-xs hover:opacity-90 transition-colors`,children:"å›å¤"})]}),t.replies.length>0&&e.jsx("div",{className:"mt-3 text-sm",children:t.replies.map(r=>e.jsxs("div",{className:`${s?"border-gray-700":"border-gray-200"} border-t py-2 flex items-center justify-between`,children:[e.jsx("span",{children:r.content}),e.jsx("button",{onClick:()=>Z(t.id,r.id),"aria-label":"åˆ é™¤å›å¤",className:`${s?"bg-gray-800 text-white":"bg-white text-gray-900"} px-2 py-0.5 rounded-lg text-xs ring-1 ${s?"ring-gray-700":"ring-gray-200"} transition-colors`,children:"åˆ é™¤"})]},r.id))})]},t.id)),z.length===0&&e.jsx("div",{className:"text-sm opacity-60",children:"æš‚æ— è®¨è®ºï¼Œå‘å¸ƒç¬¬ä¸€æ¡å§ï½"})]})]})]})]})};export{te as CommunityDiscussion,ee as DiscussionSection};
