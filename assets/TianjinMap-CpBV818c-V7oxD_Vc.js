import{aD as he,C as E,c as t,aS as xe,az as me,b4 as le}from"./index-DvRCDgMZ.js";const se=g=>{let n;const a=new Set,d=(i,A)=>{const j=typeof i=="function"?i(n):i;if(!Object.is(j,n)){const N=n;n=A??(typeof j!="object"||j===null)?j:Object.assign({},n,j),a.forEach(R=>R(n,N))}},y=()=>n,w={setState:d,getState:y,getInitialState:()=>v,subscribe:i=>(a.add(i),()=>a.delete(i))},v=n=g(d,y,w);return w},fe=(g=>g?se(g):se),ye=g=>g;function ue(g,n=ye){const a=le.useSyncExternalStore(g.subscribe,le.useCallback(()=>n(g.getState()),[g,n]),le.useCallback(()=>n(g.getInitialState()),[g,n]));return le.useDebugValue(a),a}const ne=g=>{const n=fe(g),a=d=>ue(n,d);return Object.assign(a,n),a},pe=(g=>g?ne(g):ne),we=[{name:"é»˜è®¤ä¸»é¢˜",backgroundColor:"#f8fafc",gridColor:"#e2e8f0",regionFillOpacity:.3,poiIconSize:14,pathColor:"#3b82f6",textColor:"#1e293b"},{name:"æ·±è‰²ä¸»é¢˜",backgroundColor:"#0f172a",gridColor:"#334155",regionFillOpacity:.4,poiIconSize:14,pathColor:"#60a5fa",textColor:"#f1f5f9"},{name:"é«˜å¯¹æ¯”åº¦ä¸»é¢˜",backgroundColor:"#ffffff",gridColor:"#d1d5db",regionFillOpacity:.5,poiIconSize:16,pathColor:"#ef4444",textColor:"#000000"}],X={initialCenter:{x:500,y:500},initialZoom:5,minZoom:1,maxZoom:10,themes:we},Q=pe((g,n)=>({center:X.initialCenter,zoom:X.initialZoom,targetZoom:X.initialZoom,targetCenter:X.initialCenter,theme:X.themes[0],themes:X.themes,regions:[],pois:[],paths:[],isDragging:!1,dragStart:null,lastDragPosition:null,dragVelocity:{x:0,y:0},width:0,height:0,hoveredPOIId:null,setConfig:a=>{g(d=>{const y={};return a.initialCenter&&(a.initialCenter.x!==d.center.x||a.initialCenter.y!==d.center.y)&&(y.center=a.initialCenter),a.initialZoom!==void 0&&a.initialZoom!==d.zoom&&(y.zoom=a.initialZoom),Object.keys(y).length>0?y:d})},setSize:(a,d)=>{g({width:a,height:d})},setInitialData:a=>{console.log("setInitialData called with:",a),g({regions:a.regions||[],pois:a.pois||[],paths:a.paths||[]})},easeOutCubic:a=>1-Math.pow(1-a,3),setCenter:a=>{g({targetCenter:a});const d=performance.now(),y=n().center,w=Math.sqrt(Math.pow(a.x-y.x,2)+Math.pow(a.y-y.y,2)),v=Math.min(500,Math.max(100,w*.5)),i=()=>{const A=performance.now()-d,j=Math.min(A/v,1),N=n().easeOutCubic(j),R=a.x-y.x,B=a.y-y.y,D={x:y.x+R*N,y:y.y+B*N};g({center:D}),j<1&&requestAnimationFrame(i)};i()},updateCenter:a=>{g({center:a,targetCenter:a})},setZoom:a=>{const d=Math.max(X.minZoom,Math.min(X.maxZoom,a));g({targetZoom:d});const y=performance.now(),w=n().zoom,v=Math.abs(d-w),i=Math.min(400,Math.max(100,v*80)),A=()=>{const j=performance.now()-y,N=Math.min(j/i,1),R=n().easeOutCubic(N),B=d-w,D=w+B*R;g({zoom:D}),N<1&&requestAnimationFrame(A)};A()},updateZoom:a=>{const d=Math.max(X.minZoom,Math.min(X.maxZoom,a));g({zoom:d,targetZoom:d})},zoomIn:()=>{n().setZoom(n().targetZoom+1)},zoomOut:()=>{n().setZoom(n().targetZoom-1)},startDrag:a=>{g({isDragging:!0,dragStart:a,lastDragPosition:a,dragVelocity:{x:0,y:0}})},drag:a=>{var d,y;const w=n();if(w.isDragging&&w.dragStart){const v=a.x-w.dragStart.x,i=a.y-w.dragStart.y,A=a.x-(((d=w.lastDragPosition)==null?void 0:d.x)||a.x),j=a.y-(((y=w.lastDragPosition)==null?void 0:y.y)||a.y),N={x:w.center.x-v,y:w.center.y-i};g({center:N,targetCenter:N,dragStart:a,lastDragPosition:a,dragVelocity:{x:A,y:j}})}},endDrag:()=>{const a=n().dragVelocity||{x:0,y:0};if(Math.sqrt(a.x*a.x+a.y*a.y)>1){let d=.95;const y=()=>{const w=n(),v=w.dragVelocity||{x:0,y:0},i=Math.sqrt(v.x*v.x+v.y*v.y);if(i<.5){g({isDragging:!1,dragStart:null,dragVelocity:{x:0,y:0}});return}d=Math.max(.85,.95-.05*(i/100));const A=v.x*d,j=v.y*d,N={x:w.center.x-A,y:w.center.y-j};g({center:N,targetCenter:N,dragVelocity:{x:A,y:j}}),requestAnimationFrame(y)};y()}else g({isDragging:!1,dragStart:null,dragVelocity:{x:0,y:0}})},addRegion:a=>{if(!a||!a.id||!a.coordinates||!Array.isArray(a.coordinates)){console.warn("æ— æ•ˆçš„åŒºåŸŸæ•°æ®:",a);return}g(d=>({regions:[...d.regions,a]}))},removeRegion:a=>{g(d=>({regions:d.regions.filter(y=>y.id!==a)}))},clearRegions:()=>{g({regions:[]})},addPOI:a=>{if(!a||!a.id||!a.coordinate){console.warn("æ— æ•ˆçš„POIæ•°æ®:",a);return}g(d=>({pois:[...d.pois,a]}))},removePOI:a=>{g(d=>({pois:d.pois.filter(y=>y.id!==a)}))},clearPOIs:()=>{g({pois:[]})},addPath:a=>{if(!a||!a.id||!a.points||!Array.isArray(a.points)){console.warn("æ— æ•ˆçš„è·¯å¾„æ•°æ®:",a);return}g(d=>({paths:[...d.paths,a]}))},removePath:a=>{g(d=>({paths:d.paths.filter(y=>y.id!==a)}))},clearPaths:()=>{g({paths:[]})},setTheme:a=>g({theme:a}),updateTheme:a=>g({theme:a}),setHoveredPOI:a=>g({hoveredPOIId:a}),screenToWorld:a=>{const d=n(),y=Math.pow(2,d.zoom-1);return{x:d.center.x+(a.x-d.width/2)/y,y:d.center.y+(a.y-d.height/2)/y}},worldToScreen:a=>{const d=n(),y=Math.pow(2,d.zoom-1);return{x:d.width/2+(a.x-d.center.x)*y,y:d.height/2+(a.y-d.center.y)*y}},getViewport:()=>{const a=n(),d=Math.pow(2,a.zoom-1),y=a.width/d,w=a.height/d;return{x:a.center.x-y/2,y:a.center.y-w/2,width:y,height:w}}})),be=({className:g=""})=>{const n=E.useRef(null),a=E.useRef(null),[d,y]=E.useState(!1),{center:w,zoom:v,theme:i,regions:A,pois:j,paths:N,worldToScreen:R,getViewport:B,setSize:D,hoveredPOIId:F}=Q(),I=E.useCallback(()=>{let e=800,o=600;if(a.current){const b=a.current.getBoundingClientRect(),x=window.devicePixelRatio||1;e=b.width||800,o=b.height||600;const u=n.current;if(u){u.width=e*x,u.height=o*x,u.style.width=`${e}px`,u.style.height=`${o}px`;const r=u.getContext("2d");r&&(r.clearRect(0,0,u.width,u.height),r.scale(x,x)),y(!0)}}D(e,o)},[D]);E.useEffect(()=>(I(),window.addEventListener("resize",I),window.addEventListener("orientationchange",I),()=>{window.removeEventListener("resize",I),window.removeEventListener("orientationchange",I)}),[I]);const P=E.useMemo(()=>({viewport:B(),scale:Math.pow(2,v-1)}),[w,v,B]),Z=(e,o,b,x,u)=>{try{e.strokeStyle=i.gridColor,e.lineWidth=.5;const r=50*Math.pow(.5,Math.floor(v/2)),l=r*b;e.fillStyle="rgba(255, 255, 255, 0.05)",e.fillRect(0,0,x,u);for(let c=-20;c<21;c++){const m=w.x+c*r,p=R({x:m,y:w.y}).x;e.beginPath(),e.moveTo(p,0),e.lineTo(p,u),e.stroke()}for(let c=-20;c<21;c++){const m=w.y+c*r,p=R({x:w.x,y:m}).y;e.beginPath(),e.moveTo(0,p),e.lineTo(x,p),e.stroke()}}catch(r){console.error("ç»˜åˆ¶ç½‘æ ¼çº¿æ—¶å‡ºé”™:",r)}},K=(e,o,b,x,u)=>{const r=o.filter(l=>{if(l.zoomLevel>b||l.coordinates.length<2)return!1;let c=Number.MAX_VALUE,m=Number.MAX_VALUE,p=Number.MIN_VALUE,z=Number.MIN_VALUE;for(const C of l.coordinates)c=Math.min(c,C.x),m=Math.min(m,C.y),p=Math.max(p,C.x),z=Math.max(z,C.y);return!(p<u.x||c>u.x+u.width||z<u.y||m>u.y+u.height)});r.length!==0&&r.forEach(l=>{try{e.beginPath();const c=x(l.coordinates[0]);if(isNaN(c.x)||isNaN(c.y))return;e.moveTo(c.x,c.y);let m=!0,p=c.x,z=c.x,C=c.y,h=c.y;for(let S=1;S<l.coordinates.length;S++){const O=x(l.coordinates[S]);if(isNaN(O.x)||isNaN(O.y)){m=!1;break}p=Math.min(p,O.x),z=Math.max(z,O.x),C=Math.min(C,O.y),h=Math.max(h,O.y),e.lineTo(O.x,O.y)}if(!m)return;if(e.closePath(),e.fillStyle=l.color,e.globalAlpha=i.regionFillOpacity,e.fill(),e.globalAlpha=1,e.strokeStyle=l.borderColor,e.lineWidth=l.borderWidth,e.lineJoin="round",e.lineCap="round",e.stroke(),b>=5){const S=l.coordinates.reduce((V,$)=>V+$.x,0)/l.coordinates.length,O=l.coordinates.reduce((V,$)=>V+$.y,0)/l.coordinates.length,T=x({x:S,y:O});e.fillStyle=i.backgroundColor,e.shadowColor="rgba(0, 0, 0, 0.3)",e.shadowBlur=4,e.font="bold 14px sans-serif",e.textAlign="center",e.textBaseline="middle";const k=e.measureText(l.name).width,s=24,H=8;e.fillRect(T.x-k/2-H,T.y-s/2,k+H*2,s),e.fillStyle=i.textColor,e.shadowBlur=0,e.fillText(l.name,T.x,T.y)}}catch(c){console.warn("ç»˜åˆ¶åŒºåŸŸæ—¶å‡ºé”™:",c,"åŒºåŸŸ:",l.id)}})},L=(e,o,b,x,u,r)=>{const l=o.filter(C=>{const h=C.coordinate;return h.x>=r.x-100&&h.x<=r.x+r.width+100&&h.y>=r.y-100&&h.y<=r.y+r.height+100});if(l.length===0)return;const c=v<7,m=Math.max(20,60-(v-1)*5),p=i.poiIconSize,z=Math.max(p,p*(1+(v-1)*.2));if(c){const C={};l.forEach(h=>{const S=Math.floor(h.coordinate.x/m),O=Math.floor(h.coordinate.y/m),T=`${S},${O}`;C[T]||(C[T]=[]),C[T].push(h)}),Object.values(C).forEach(h=>{try{const S=h.reduce((f,U)=>f+(U.importance||1),0),O=h.reduce((f,U)=>f+U.coordinate.x*(U.importance||1),0)/S,T=h.reduce((f,U)=>f+U.coordinate.y*(U.importance||1),0)/S,k=u({x:O,y:T});if(isNaN(k.x)||isNaN(k.y)||k.x<-100||k.x>b+100||k.y<-100||k.y>x+100)return;const s=h.length,H=Math.max(p*1.5,p+Math.min(s*.8,30));e.save(),e.shadowColor="rgba(0, 0, 0, 0.4)",e.shadowBlur=12,e.shadowOffsetX=0,e.shadowOffsetY=4;const V={};h.forEach(f=>{V[f.category]=(V[f.category]||0)+1});const $=Object.keys(V).reduce((f,U)=>V[f]>V[U]?f:U),Y={food:"#ef4444",retail:"#3b82f6",craft:"#8b5cf6",landmark:"#f59e0b",culture:"#10b981",default:"#6b7280"},W=Y[$]||Y.default,ae=e.createRadialGradient(k.x,k.y,0,k.x,k.y,H);ae.addColorStop(0,W),ae.addColorStop(1,W+"99"),e.fillStyle=ae,e.beginPath(),e.arc(k.x,k.y,H,0,Math.PI*2),e.fill(),e.strokeStyle="#ffffff",e.lineWidth=3,e.stroke();const re=e.createRadialGradient(k.x,k.y,0,k.x,k.y,H*.6);if(re.addColorStop(0,"rgba(255, 255, 255, 0.8)"),re.addColorStop(1,"rgba(255, 255, 255, 0)"),e.fillStyle=re,e.beginPath(),e.arc(k.x,k.y,H*.6,0,Math.PI*2),e.fill(),e.restore(),e.fillStyle="#ffffff",e.font=`bold ${Math.min(H*.6,18)}px sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(s.toString(),k.x,k.y),s>1){e.save(),e.translate(k.x+H*.6,k.y-H*.6),e.scale(.5,.5),e.fillStyle="#ffffff",e.beginPath();const f=z*.8;e.fillStyle=W,e.beginPath(),e.arc(0,0,f,0,Math.PI*2),e.fill(),e.fillStyle="#ffffff",e.beginPath(),$==="food"?(e.arc(0,0,f*.7,0,Math.PI*2),e.fill(),e.fillStyle=W,e.fillRect(-f*.2,-f*.6,f*.4,f*1.2)):$==="retail"?(e.arc(0,0,f,0,Math.PI,!0),e.lineTo(-f,-f),e.lineTo(f,-f),e.closePath(),e.fill()):$==="craft"?(e.moveTo(-f,-f),e.lineTo(f,f),e.lineTo(f-f*.3,f),e.lineTo(-f+f*.3,-f),e.closePath(),e.fill()):$==="landmark"?(e.fillRect(-f,-f,f*2,f*2),e.fill(),e.fillStyle=W,e.fillRect(-f*.5,-f,f,f*2)):$==="culture"?(e.fillRect(-f,-f,f*2,f*1.8),e.fill(),e.fillStyle=W,e.fillRect(-f,-f*.3,f*2,f*.15)):(e.arc(0,0,f*.5,0,Math.PI*2),e.fill()),e.restore()}e.save(),e.globalAlpha=.3,e.fillStyle=W,e.beginPath(),e.arc(k.x,k.y,H*1.2,0,Math.PI*2),e.fill(),e.restore()}catch(S){console.warn("ç»˜åˆ¶èšç±»æ—¶å‡ºé”™:",S)}})}else l.forEach(C=>{try{const h=u(C.coordinate);if(isNaN(h.x)||isNaN(h.y)||h.x<-100||h.x>b+100||h.y<-100||h.y>x+100)return;const S=C.color||"#3b82f6",O=C.id===F,T=O?z*1.3:z;e.save(),e.shadowColor="rgba(0, 0, 0, 0.4)",e.shadowBlur=O?12:8,e.shadowOffsetX=0,e.shadowOffsetY=4;const k=e.createRadialGradient(h.x,h.y,0,h.x,h.y,T);k.addColorStop(0,S),k.addColorStop(1,S+"cc"),e.fillStyle=k,e.beginPath(),e.arc(h.x,h.y,T,0,Math.PI*2),e.fill(),e.strokeStyle="#ffffff",e.lineWidth=O?4:3,e.stroke(),e.restore(),e.fillStyle="#ffffff",e.save(),e.translate(h.x,h.y);const s=T*.7;if(e.beginPath(),C.category==="food"?(e.arc(0,0,s*.6,0,Math.PI*2),e.fill(),e.fillStyle=S,e.fillRect(-s*.2,-s*.8,s*.4,s*1.6),e.fillRect(-s*.6,-s*.2,s*1.2,s*.4)):C.category==="retail"?(e.moveTo(-s,-s),e.lineTo(-s,s*.8),e.arcTo(-s,s,0,s,s),e.arcTo(s,s,s,s*.8,s),e.lineTo(s,-s),e.lineTo(0,-s*1.5),e.closePath(),e.fill()):C.category==="craft"?(e.moveTo(-s*.3,-s),e.lineTo(s*.3,-s*.3),e.lineTo(s,0),e.lineTo(s*.3,s*.3),e.lineTo(-s*.3,s),e.lineTo(-s,0),e.closePath(),e.fill(),e.beginPath(),e.moveTo(s,0),e.lineTo(s*1.2,-s*.3),e.lineTo(s*1.2,s*.3),e.closePath(),e.fill()):C.category==="landmark"?(e.fillRect(-s,-s,s*2,s*2),e.beginPath(),e.moveTo(-s*1.2,-s),e.lineTo(0,-s*1.5),e.lineTo(s*1.2,-s),e.closePath(),e.fill(),e.fillRect(-s*.25,s*.3,s*.5,s*.7)):C.category==="culture"?(e.fillRect(-s,-s*.6,s*2,s*1.2),e.fillStyle=S,e.fillRect(-s*1.1,-s*.7,s*.2,s*1.4),e.fillStyle="#ffffff",e.fillRect(-s*.8,-s*.2,s*1.6,s*.1)):(e.arc(0,0,s*.8,0,Math.PI*2),e.fill(),e.fillStyle=S,e.arc(0,0,s*.3,0,Math.PI*2),e.fill()),e.restore(),O){e.fillStyle=i.backgroundColor,e.shadowColor="rgba(0, 0, 0, 0.3)",e.shadowBlur=8,e.shadowOffsetX=0,e.shadowOffsetY=2;const H=C.name||"";e.font="bold 14px sans-serif";const V=e.measureText(H).width,$=10,Y=24;if(e.fillRect(h.x-V/2-$,h.y+T+10,V+$*2,Y),e.fillStyle=i.textColor,e.textAlign="center",e.shadowBlur=0,e.fillText(H,h.x,h.y+T+Y/2+10),C.description){const W=C.description.length>30?C.description.substring(0,30)+"...":C.description;e.font="12px sans-serif";const ae=e.measureText(W).width,re=20;e.fillStyle=i.backgroundColor,e.shadowBlur=8,e.fillRect(h.x-ae/2-$,h.y+T+Y+14,ae+$*2,re),e.fillStyle=i.textColor,e.shadowBlur=0,e.fillText(W,h.x,h.y+T+Y+re/2+14)}}else if(v>=6){e.fillStyle=i.backgroundColor,e.shadowColor="rgba(0, 0, 0, 0.3)",e.shadowBlur=6,e.shadowOffsetX=0,e.shadowOffsetY=2;const H=C.name||"";e.font="bold 13px sans-serif";const V=e.measureText(H).width,$=8,Y=22;e.fillRect(h.x-V/2-$,h.y+T+8,V+$*2,Y),e.fillStyle=i.textColor,e.textAlign="center",e.shadowBlur=0,e.fillText(H,h.x,h.y+T+Y/2+8)}}catch(h){console.warn("ç»˜åˆ¶POIæ—¶å‡ºé”™:",h,"POI:",C.id)}})},J=(e,o,b,x)=>{const u=o.filter(r=>{if(r.points.length<2)return!1;let l=Number.MAX_VALUE,c=Number.MAX_VALUE,m=Number.MIN_VALUE,p=Number.MIN_VALUE;for(const z of r.points){const C=z.coordinate;l=Math.min(l,C.x),c=Math.min(c,C.y),m=Math.max(m,C.x),p=Math.max(p,C.y)}return!(m<x.x||l>x.x+x.width||p<x.y||c>x.y+x.height)});u.length!==0&&u.forEach(r=>{try{e.beginPath();const l=b(r.points[0].coordinate);if(isNaN(l.x)||isNaN(l.y))return;e.moveTo(l.x,l.y);let c=!0;for(let m=1;m<r.points.length;m++){const p=b(r.points[m].coordinate);if(isNaN(p.x)||isNaN(p.y)){c=!1;break}e.lineTo(p.x,p.y)}if(!c)return;e.strokeStyle=r.color||"#3b82f6",e.lineWidth=r.width||3,e.lineCap="round",e.lineJoin="round",e.stroke(),v>=6&&r.points.forEach(m=>{try{if(m.isWaypoint){const p=b(m.coordinate);if(isNaN(p.x)||isNaN(p.y))return;e.fillStyle="#ffffff",e.beginPath(),e.arc(p.x,p.y,(r.width||3)+4,0,Math.PI*2),e.fill(),e.fillStyle=r.color||"#3b82f6",e.beginPath(),e.arc(p.x,p.y,(r.width||3)+2,0,Math.PI*2),e.fill()}}catch(p){console.warn("ç»˜åˆ¶è·¯å¾„ç‚¹æ—¶å‡ºé”™:",p)}})}catch(l){console.warn("ç»˜åˆ¶è·¯å¾„æ—¶å‡ºé”™:",l,"è·¯å¾„:",r.id)}})},[G,ie]=E.useState({renderTime:0,fps:60,poiCount:0,regionCount:0,pathCount:0,visiblePoiCount:0}),ee=E.useRef({frameCount:0,lastTime:performance.now(),currentFps:60}),te=E.useCallback((e,o)=>{const b=performance.now();try{e.fillStyle=i.backgroundColor,e.fillRect(0,0,o.width,o.height),v<=6&&Z(e,P.viewport,P.scale,o.width,o.height),K(e,A,v,R,P.viewport),J(e,N,R,P.viewport),L(e,j,o.width,o.height,R,P.viewport);const x=performance.now()-b,u=ee.current;u.frameCount++;const r=performance.now();r-u.lastTime>=1e3&&(u.currentFps=Math.round(u.frameCount*1e3/(r-u.lastTime)),u.frameCount=0,u.lastTime=r),ie(l=>({...l,renderTime:parseFloat(x.toFixed(2)),fps:u.currentFps,poiCount:j.length,regionCount:A.length,pathCount:N.length,visiblePoiCount:j.filter(c=>{const m=c.coordinate;return m.x>=P.viewport.x-100&&m.x<=P.viewport.x+P.viewport.width+100&&m.y>=P.viewport.y-100&&m.y<=P.viewport.y+P.viewport.height+100}).length}))}catch(x){console.error("åœ°å›¾ç»˜åˆ¶é”™è¯¯:",x)}},[i,A,v,N,j,R,P,F]),q=E.useRef({animationFrameId:0,lastRenderTime:0,pendingRender:!1,shouldRender:!1});return E.useEffect(()=>{q.current.shouldRender=!0},[w,v,i,A,N,j,F,P]),E.useEffect(()=>{if(!d)return;const e=16,o=n.current;if(!o)return;const b=o.getContext("2d");if(!b)return;const x=r=>{const l=q.current;if(r-l.lastRenderTime<e){l.shouldRender&&(l.animationFrameId=requestAnimationFrame(x));return}if(l.shouldRender)try{te(b,o),l.lastRenderTime=r,l.shouldRender=!1}catch(c){console.error("åœ°å›¾æ¸²æŸ“é”™è¯¯:",c)}l.shouldRender&&(l.animationFrameId=requestAnimationFrame(x))};q.current.animationFrameId=requestAnimationFrame(x);const u=()=>{q.current.shouldRender=!0,requestAnimationFrame(x)};return window.addEventListener("resize",u),()=>{cancelAnimationFrame(q.current.animationFrameId),window.removeEventListener("resize",u)}},[d,te,w,v,i,A,N,j,F,P]),t.jsx("div",{ref:a,className:`${g} relative w-full h-full`,children:t.jsx("canvas",{ref:n,className:"w-full h-full",style:{display:"block",cursor:"grab",userSelect:"none"}})})},ve=({children:g,onPOIClick:n,onMapClick:a})=>{const{isDragging:d,startDrag:y,drag:w,endDrag:v,zoomIn:i,zoomOut:A,setZoom:j,screenToWorld:N,worldToScreen:R,pois:B,setHoveredPOI:D}=Q(),[F,I]=E.useState(null),[P,Z]=E.useState(null),K=r=>{if(r.button!==0)return;const l={x:r.clientX,y:r.clientY};y(l)},L=r=>{try{const l=Q.getState(),c=l.zoom;if(c===void 0)return null;const m=Math.min(40,25+(c-1)*2),p=m*m,z=l.getViewport();if(!z)return null;const C=B.filter(h=>{const S=h.coordinate;return S.x>=z.x-m&&S.x<=z.x+z.width+m&&S.y>=z.y-m&&S.y<=z.y+z.height+m});for(const h of C){const S=R(h.coordinate),O=r.x-S.x,T=r.y-S.y;if(O*O+T*T<=p)return h}}catch(l){console.error("æ£€æŸ¥POIäº¤äº’æ—¶å‡ºé”™:",l)}return null},J=(r,l)=>{let c;return function(...m){const p=()=>{clearTimeout(c),r(...m)};clearTimeout(c),c=setTimeout(p,l)}},G=le.useCallback(J(r=>{const l=L(r);D(l?l.id:null)},30),[L,D]),ie=r=>{const l={x:r.clientX,y:r.clientY};w(l);try{const c=r.currentTarget.getBoundingClientRect(),m=r.clientX-c.left,p=r.clientY-c.top;G({x:m,y:p})}catch(c){console.error("å¤„ç†é¼ æ ‡æ‚¬åœäº‹ä»¶æ—¶å‡ºé”™:",c)}},ee=()=>{v()},te=()=>{v(),D(null)},q=r=>{r.preventDefault();const l=.15,c=r.deltaY>0?-l:l,m=Q.getState().zoom;if(m===void 0)return;const p=m+c;j(p)},e=r=>{try{const l=r.currentTarget.getBoundingClientRect(),c=r.clientX-l.left,m=r.clientY-l.top,p={x:c,y:m},z=N(p),C=L(p);if(C&&n){console.log("ç‚¹å‡»äº†POI:",C.id,C.name),n(C.id);return}a&&a(z)}catch(l){console.error("å¤„ç†åœ°å›¾ç‚¹å‡»äº‹ä»¶æ—¶å‡ºé”™:",l)}},o=r=>{if(r.preventDefault(),r.touches.length===1){const l=r.touches[0],c={x:l.clientX,y:l.clientY};I(c),y(c)}else if(r.touches.length===2){const l=r.touches[0],c=r.touches[1],m=Math.sqrt(Math.pow(c.clientX-l.clientX,2)+Math.pow(c.clientY-l.clientY,2));Z(m)}},b=r=>{if(r.preventDefault(),r.touches.length===1){if(!F)return;const l=r.touches[0],c={x:l.clientX,y:l.clientY};w(c),I(c)}else if(r.touches.length===2){const l=r.touches[0],c=r.touches[1],m=Math.sqrt(Math.pow(c.clientX-l.clientX,2)+Math.pow(c.clientY-l.clientY,2));if(P){const p=m/P,z=Q.getState().zoom,C=(p-1)*.5,h=z+C;j(h)}Z(m)}},x=r=>{r.preventDefault(),I(null),Z(null),v()},u=()=>{I(null),Z(null),v()};return t.jsx("div",{style:{width:"100%",height:"100%",position:"relative",overflow:"hidden",cursor:d?"grabbing":"grab",touchAction:"none",background:"transparent"},onMouseDown:K,onMouseMove:ie,onMouseUp:ee,onMouseLeave:te,onWheel:q,onClick:e,onContextMenu:r=>r.preventDefault(),onTouchStart:o,onTouchMove:b,onTouchEnd:x,onTouchCancel:u,children:g})},Ce=({className:g=""})=>{const{zoom:n,zoomIn:a,zoomOut:d,center:y,updateCenter:w,themes:v,setTheme:i,width:A,getViewport:j}=Q(),N=X.minZoom,R=X.maxZoom;j();const B=1/Math.pow(2,n-1)/100,D=()=>{try{const I=Q.getState().theme;if(!v||!I)return;const P=(v.findIndex(Z=>Z.name===I.name)+1)%v.length;i(v[P])}catch(I){console.error("åˆ‡æ¢ä¸»é¢˜æ—¶å‡ºé”™:",I)}},F=()=>{w({x:500,y:500})};return t.jsxs("div",{className:`absolute top-4 right-4 z-10 flex flex-col gap-2 ${g}`,children:[t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700",children:[t.jsx("button",{className:"w-10 h-10 flex items-center justify-center text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-t-lg transition-colors",onClick:a,disabled:n>=R,"aria-label":"æ”¾å¤§åœ°å›¾",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),t.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700"}),t.jsx("div",{className:"w-10 h-10 flex items-center justify-center text-gray-600 dark:text-gray-400 text-sm font-medium",children:n}),t.jsx("div",{className:"h-px bg-gray-200 dark:bg-gray-700"}),t.jsx("button",{className:"w-10 h-10 flex items-center justify-center text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-b-lg transition-colors",onClick:d,disabled:n<=N,"aria-label":"ç¼©å°åœ°å›¾",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})})]}),t.jsx("button",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 w-10 h-10 flex items-center justify-center text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:D,"aria-label":"åˆ‡æ¢åœ°å›¾ä¸»é¢˜",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01"})})}),t.jsx("button",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 w-10 h-10 flex items-center justify-center text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",onClick:F,"aria-label":"é‡ç½®åœ°å›¾è§†å›¾",children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 6.75V15m6-6v8.25m.503 3.498 4.875-2.437c.381-.19.622-.58.622-1.006V4.82c0-.836-.88-1.38-1.628-1.006l-3.869 1.934c-.317.159-.69.159-1.006 0L9.503 3.252a1.125 1.125 0 00-1.006 0L3.622 5.689C3.33 5.88 3 6.27 3 6.695V18c0 .836.88 1.38 1.628 1.006l3.869-1.934c.317-.159.69-.159 1.006 0l4.994 2.497c.317.158.69.158 1.006 0z"})})}),t.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 px-3 py-2 flex items-center gap-2",children:[t.jsx("div",{className:"h-4 border-r border-gray-300 dark:border-gray-600 w-1"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("div",{className:"w-12 h-1 bg-blue-500"}),t.jsx("div",{className:"w-6 h-1 border border-gray-300 dark:border-gray-600 bg-transparent"})]}),t.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 whitespace-nowrap",children:[(B*18).toFixed(1)," km"]})]})]})},Ee=({width:g,height:n,config:a={},initialRegions:d=[],initialPOIs:y=[],initialPaths:w=[],onPOIClick:v,onMapClick:i,className:A="",style:j})=>{const N=E.useRef(null),{setSize:R,setInitialData:B,updateZoom:D,updateCenter:F,updateTheme:I}=Q();E.useEffect(()=>{try{console.log("VirtualMap: åˆå§‹åŒ–åœ°å›¾æ•°æ®",{regionsCount:d.length,poisCount:y.length,pathsCount:w.length}),B({regions:d,pois:y,paths:w})}catch(L){console.error("åˆå§‹åŒ–åœ°å›¾æ•°æ®æ—¶å‡ºé”™:",L)}},[d,y,w,B]);const P=()=>{if(!N.current)return;const L=N.current.getBoundingClientRect(),J=L.width||800,G=L.height||600;R(J,G)};E.useEffect(()=>(P(),window.addEventListener("resize",P),()=>{window.removeEventListener("resize",P)}),[R]),E.useEffect(()=>{P()},[g,n,R]);const Z=L=>{v&&v(L)},K=L=>{i&&i(L)};return t.jsxs("div",{ref:N,className:`relative w-full h-full ${A} overflow-hidden`,style:j,children:[t.jsx(ve,{onPOIClick:Z,onMapClick:K,children:t.jsx(be,{className:"w-full h-full"})}),t.jsx(Ce,{})]})},de={food:"ðŸœ",retail:"ðŸª",craft:"ðŸŽ¨",landmark:"ðŸ°",culture:"ðŸ“š"},ce={food:"bg-yellow-500",retail:"bg-blue-500",craft:"bg-purple-500",landmark:"bg-red-500",culture:"bg-green-500"},M={1:[117.1881,39.1252],2:[117.2315,39.0923],3:[117.1598,39.1445],4:[117.1955,39.1278],5:[117.0538,39.1402],6:[117.1995,39.1408],7:[117.1468,39.1425],8:[117.2293,39.0948]},oe={categories:{food:{name:"é¤é¥®ç¾Žé£Ÿ",icon:"ðŸœ",color:"bg-yellow-500"},retail:{name:"é›¶å”®ç™¾è´§",icon:"ðŸª",color:"bg-blue-500"},craft:{name:"æ‰‹å·¥è‰º",icon:"ðŸŽ¨",color:"bg-purple-500"},landmark:{name:"åœ°æ ‡å»ºç­‘",icon:"ðŸ°",color:"bg-red-500"},culture:{name:"æ–‡åŒ–è‰ºæœ¯",icon:"ðŸ“š",color:"bg-green-500"}},poi:[{id:1,name:"ç‹—ä¸ç†åŒ…å­",category:"food",description:"å¤©æ´¥è‘—åçš„ä¼ ç»Ÿå°åƒï¼Œä»¥çš®è–„é¦…å¤§ã€é²œé¦™å¯å£è‘—ç§°ï¼Œæœ‰ç€æ‚ ä¹…çš„åŽ†å²å’Œæ–‡åŒ–åº•è•´ã€‚ç‹—ä¸ç†åŒ…å­çš„åˆ¶ä½œæŠ€è‰ºè¢«åˆ—å…¥å›½å®¶çº§éžç‰©è´¨æ–‡åŒ–é—äº§åå½•ã€‚",address:"å¤©æ´¥å¸‚å’Œå¹³åŒºå±±ä¸œè·¯77å·",position:{x:45,y:55,lng:M[1][0],lat:M[1][1]},year:1858,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eç‹—ä¸ç†åŒ…å­%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥ä¸‰ç»ä¹‹ä¸€%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eç‹—ä¸ç†åŒ…å­%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eä¼ ç»Ÿå°åƒ%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eç‹—ä¸ç†åŒ…å­%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eç™¾å¹´è€åº—%3C/text%3E%3C/svg%3E"],openingHours:"08:00-22:00",phone:"022-27306590",importance:5,tags:["å¤©æ´¥ä¸‰ç»","ä¼ ç»Ÿå°åƒ","ç™¾å¹´è€åº—"],featuredProducts:["çŒªè‚‰åŒ…å­","ä¸‰é²œåŒ…å­","èŸ¹é»„åŒ…å­","é‡ŽèœåŒ…å­"],honors:["å›½å®¶çº§éžç‰©è´¨æ–‡åŒ–é—äº§","ä¸­åŽè€å­—å·","å¤©æ´¥åå°åƒ"],historicalSignificance:"ç‹—ä¸ç†åŒ…å­å§‹åˆ›äºŽ1858å¹´ï¼Œç”±é«˜è´µå‹åˆ›ç«‹ï¼Œæ˜¯å¤©æ´¥ä¼ ç»Ÿé¥®é£Ÿæ–‡åŒ–çš„é‡è¦ä»£è¡¨ï¼Œè§è¯äº†å¤©æ´¥è¿‘ä»£å•†ä¸šçš„å‘å±•åŽ†ç¨‹ã€‚",culturalHeritageLevel:"å›½å®¶çº§",relatedPois:[2,3]},{id:2,name:"åå…«è¡—éº»èŠ±",category:"food",description:"å¤©æ´¥ä¼ ç»Ÿåç‚¹ï¼Œä»¥é…¥è„†é¦™ç”œã€ä¹…æ”¾ä¸ç»µè€Œé—»åï¼Œæ˜¯å¤©æ´¥ä¸‰ç»ä¹‹ä¸€ã€‚",address:"å¤©æ´¥å¸‚æ²³è¥¿åŒºå¤§æ²½å—è·¯566å·",position:{x:50,y:60,lng:M[2][0],lat:M[2][1]},year:1912,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eåå…«è¡—éº»èŠ±%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥ä¸‰ç»ä¹‹ä¸€%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eåå…«è¡—éº»èŠ±%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eä¼ ç»Ÿåç‚¹%3C/text%3E%3C/svg%3E"],openingHours:"09:00-21:00",phone:"022-28326900",importance:4,tags:["å¤©æ´¥ä¸‰ç»","ä¼ ç»Ÿåç‚¹","ç™¾å¹´è€åº—"],relatedPois:[1,3]},{id:3,name:"è€³æœµçœ¼ç‚¸ç³•",category:"food",description:"å¤©æ´¥ä¼ ç»Ÿé£Žå‘³å°åƒï¼Œä»¥çš®é…¥è„†ã€é¦…é¦™ç”œã€ä¸è…»å£è€Œè‘—ç§°ï¼Œæ˜¯å¤©æ´¥ä¸‰ç»ä¹‹ä¸€ã€‚",address:"å¤©æ´¥å¸‚çº¢æ¡¥åŒºåŒ—é—¨å¤–å¤§è¡—12å·",position:{x:48,y:52,lng:M[3][0],lat:M[3][1]},year:1900,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eè€³æœµçœ¼ç‚¸ç³•%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥ä¸‰ç»ä¹‹ä¸€%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eè€³æœµçœ¼ç‚¸ç³•%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eä¼ ç»Ÿå°åƒ%3C/text%3E%3C/svg%3E"],openingHours:"08:30-20:30",phone:"022-27275033",importance:4,tags:["å¤©æ´¥ä¸‰ç»","ä¼ ç»Ÿå°åƒ","ç™¾å¹´è€åº—"],relatedPois:[1,2]},{id:4,name:"åŠä¸šåœº",category:"retail",description:"å¤©æ´¥è‘—åçš„ç™¾å¹´è€å•†åœºï¼Œæ˜¯å¤©æ´¥å•†ä¸šçš„æ ‡å¿—æ€§å»ºç­‘ï¼Œèžåˆäº†å¤šç§å»ºç­‘é£Žæ ¼ã€‚",address:"å¤©æ´¥å¸‚å’Œå¹³åŒºå’Œå¹³è·¯290å·",position:{x:47,y:56,lng:M[4][0],lat:M[4][1]},year:1928,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3EåŠä¸šåœº%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eç™¾å¹´è€åº—%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3EåŠä¸šåœº%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eå•†ä¸šåœ°æ ‡%3C/text%3E%3C/svg%3E"],openingHours:"10:00-22:00",phone:"022-27211818",importance:5,tags:["ç™¾å¹´è€åº—","å•†ä¸šåœ°æ ‡","åŽ†å²å»ºç­‘"],relatedPois:[7]},{id:5,name:"æ¨æŸ³é’å¹´ç”»",category:"craft",description:"ä¸­å›½å››å¤§æœ¨ç‰ˆå¹´ç”»ä¹‹ä¸€ï¼Œä»¥è‰²å½©è‰³ä¸½ã€é¢˜æä¸°å¯Œã€æž„å›¾é¥±æ»¡è€Œè‘—ç§°ï¼Œå…·æœ‰æµ“éƒçš„æ°‘é—´è‰ºæœ¯ç‰¹è‰²ã€‚",address:"å¤©æ´¥å¸‚è¥¿é’åŒºæ¨æŸ³é’é•‡ä¼°è¡£è¡—23å·",position:{x:42,y:48,lng:M[5][0],lat:M[5][1]},year:1600,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eæ¨æŸ³é’å¹´ç”»%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eæ°‘é—´è‰ºæœ¯%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eæ¨æŸ³é’å¹´ç”»%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eå›½å®¶çº§éžé—%3C/text%3E%3C/svg%3E"],openingHours:"09:00-17:00",phone:"022-27940617",importance:5,tags:["æ°‘é—´è‰ºæœ¯","å›½å®¶çº§éžé—","ä¼ ç»Ÿå·¥è‰º"],relatedPois:[6]},{id:6,name:"æ³¥äººå¼ å½©å¡‘",category:"craft",description:"å¤©æ´¥ä¼ ç»Ÿæ°‘é—´è‰ºæœ¯ï¼Œä»¥å½¢ç¥žå…¼å¤‡ã€è‰²å½©é²œæ˜Žã€åšå·¥ç²¾ç»†è€Œé—»åï¼Œæ˜¯ä¸­å›½æ³¥å¡‘è‰ºæœ¯çš„ä»£è¡¨ã€‚",address:"å¤©æ´¥å¸‚å—å¼€åŒºå¤æ–‡åŒ–è¡—å®«åŒ—å¤§è¡—é€šåº†é‡Œ4å·",position:{x:46,y:54,lng:M[6][0],lat:M[6][1]},year:1844,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eæ³¥äººå¼ å½©å¡‘%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eæ°‘é—´è‰ºæœ¯%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eæ³¥äººå¼ å½©å¡‘%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eä¼ ç»Ÿå·¥è‰º%3C/text%3E%3C/svg%3E"],openingHours:"09:00-18:00",phone:"022-27353157",importance:5,tags:["æ°‘é—´è‰ºæœ¯","å›½å®¶çº§éžé—","ä¼ ç»Ÿå·¥è‰º"],relatedPois:[5]},{id:7,name:"å¤©æ´¥ä¹‹çœ¼",category:"landmark",description:"ä¸–ç•Œä¸Šå”¯ä¸€å»ºåœ¨æ¡¥ä¸Šçš„æ‘©å¤©è½®ï¼Œæ˜¯å¤©æ´¥çš„æ ‡å¿—æ€§å»ºç­‘ä¹‹ä¸€ï¼Œä¿¯çž°å¤©æ´¥å¸‚åŒºå…¨æ™¯ã€‚",address:"å¤©æ´¥å¸‚çº¢æ¡¥åŒºæŽå…¬ç¥ å¤§è¡—ä¸Žäº”é©¬è·¯äº¤å£",position:{x:44,y:50,lng:M[7][0],lat:M[7][1]},year:2008,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥ä¹‹çœ¼%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3EçŽ°ä»£åœ°æ ‡%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥ä¹‹çœ¼%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eæ—…æ¸¸æ™¯ç‚¹%3C/text%3E%3C/svg%3E"],openingHours:"09:30-21:30",phone:"022-26288830",importance:5,tags:["çŽ°ä»£åœ°æ ‡","æ—…æ¸¸æ™¯ç‚¹","åŸŽå¸‚åç‰‡"],relatedPois:[4]},{id:8,name:"å¤©æ´¥å¤§å‰§é™¢",category:"culture",description:"çŽ°ä»£åŒ–çš„å¤§åž‹ç»¼åˆå‰§åœºï¼Œæ˜¯å¤©æ´¥æ–‡åŒ–è‰ºæœ¯çš„é‡è¦é˜µåœ°ï¼Œä¸¾åŠžå„ç±»é«˜æ°´å¹³æ¼”å‡ºã€‚",address:"å¤©æ´¥å¸‚æ²³è¥¿åŒºå¹³æ±Ÿé“58å·",position:{x:49,y:58,lng:M[8][0],lat:M[8][1]},year:2012,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥å¤§å‰§é™¢%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eæ–‡åŒ–è®¾æ–½%3C/text%3E%3C/svg%3E","data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥å¤§å‰§é™¢%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eè‰ºæœ¯æ®¿å ‚%3C/text%3E%3C/svg%3E"],openingHours:"æ ¹æ®æ¼”å‡ºæ—¶é—´è€Œå®š",phone:"022-83882000",importance:4,tags:["çŽ°ä»£å»ºç­‘","æ–‡åŒ–è®¾æ–½","è‰ºæœ¯æ®¿å ‚"],featuredProducts:["æ­Œå‰§æ¼”å‡º","éŸ³ä¹ä¼š","è¯å‰§","èˆžè¹ˆè¡¨æ¼”"],honors:["å›½å®¶å¤§å‰§é™¢è”ç›Ÿæˆå‘˜","å¤©æ´¥å¸‚æ–‡åŒ–åœ°æ ‡"],culturalHeritageLevel:"å¸‚çº§",relatedPois:[7]},{id:9,name:"è€ç¾ŽåŽ",category:"retail",description:"å¤©æ´¥è‘—åçš„éž‹åº—ï¼Œä»¥åˆ¶ä½œä¼ ç»Ÿå¸ƒéž‹è€Œé—»åï¼Œæœ‰ç€ç™¾å¹´åŽ†å²ï¼Œæ˜¯å¤©æ´¥ä¼ ç»Ÿå•†ä¸šçš„ä»£è¡¨ã€‚",address:"å¤©æ´¥å¸‚å’Œå¹³åŒºå’Œå¹³è·¯290å·åŠä¸šåœºåº•å•†",position:{x:46,y:55,lng:M[1][0]+.01,lat:M[1][1]+.01},year:1911,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eè€ç¾ŽåŽ%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eç™¾å¹´éž‹åº—%3C/text%3E%3C/svg%3E"],openingHours:"09:30-21:00",phone:"022-27211587",importance:5,tags:["ç™¾å¹´è€åº—","ä¼ ç»Ÿå¸ƒéž‹","ä¸­åŽè€å­—å·"],featuredProducts:["ä¼ ç»Ÿå¸ƒéž‹","æ‰‹å·¥çš®éž‹","ä¸­è€å¹´éž‹","ç¤¼å“éž‹"],honors:["ä¸­åŽè€å­—å·","å›½å®¶çº§éžç‰©è´¨æ–‡åŒ–é—äº§","å¤©æ´¥åç‰Œäº§å“"],historicalSignificance:"è€ç¾ŽåŽå§‹åˆ›äºŽ1911å¹´ï¼Œç”±åºžé¹¤å¹´åˆ›ç«‹ï¼Œæ˜¯å¤©æ´¥ä¼ ç»Ÿå•†ä¸šçš„ä»£è¡¨ï¼Œè§è¯äº†å¤©æ´¥è¿‘ä»£å•†ä¸šçš„å‘å±•åŽ†ç¨‹ã€‚",culturalHeritageLevel:"å›½å®¶çº§",relatedPois:[4]},{id:10,name:"æžœä»å¼ ",category:"food",description:"å¤©æ´¥è‘—åçš„ä¼ ç»Ÿå°åƒï¼Œä»¥åˆ¶ä½œå„ç§é£Žå‘³æžœä»è€Œé—»åï¼Œæœ‰ç€æ‚ ä¹…çš„åŽ†å²å’Œç‹¬ç‰¹çš„åˆ¶ä½œå·¥è‰ºã€‚",address:"å¤©æ´¥å¸‚å—å¼€åŒºå¤æ–‡åŒ–è¡—å®«åŒ—å¤§è¡—10å·",position:{x:45,y:52,lng:M[3][0]+.01,lat:M[3][1]+.01},year:1830,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eæžœä»å¼ %3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eä¼ ç»Ÿå°åƒ%3C/text%3E%3C/svg%3E"],openingHours:"09:00-19:00",phone:"022-27355368",importance:4,tags:["å¤©æ´¥åå°åƒ","ä¼ ç»Ÿé£Ÿå“","ç™¾å¹´è€åº—"],featuredProducts:["äº”é¦™æžœä»","ç¥ç€æ¡ƒä»","éº»è¾£èŠ±ç”Ÿ","æ€ªå‘³è±†"],honors:["ä¸­åŽè€å­—å·","å¤©æ´¥åå°åƒ","å›½å®¶çº§éžç‰©è´¨æ–‡åŒ–é—äº§"],historicalSignificance:"æžœä»å¼ å§‹åˆ›äºŽ1830å¹´ï¼Œç”±å¼ æƒ å±±åˆ›ç«‹ï¼Œæ˜¯å¤©æ´¥ä¼ ç»Ÿå°åƒçš„ä»£è¡¨ï¼Œåˆ¶ä½œæŠ€è‰ºç‹¬ç‰¹ï¼Œé£Žå‘³å„å¼‚ã€‚",culturalHeritageLevel:"å›½å®¶çº§",relatedPois:[5,6]},{id:11,name:"å¤©æ´¥å¤æ–‡åŒ–è¡—",category:"landmark",description:"å¤©æ´¥è‘—åçš„æ–‡åŒ–æ—…æ¸¸æ™¯ç‚¹ï¼Œé›†ä¼ ç»Ÿå•†ä¸šã€æ–‡åŒ–å±•ç¤ºã€æ—…æ¸¸è§‚å…‰äºŽä¸€ä½“ï¼Œæ˜¯å¤©æ´¥ä¼ ç»Ÿæ–‡åŒ–çš„é‡è¦è½½ä½“ã€‚",address:"å¤©æ´¥å¸‚å—å¼€åŒºä¸œé—¨å¤–å¤§è¡—å®«åŒ—å¤§è¡—",position:{x:45,y:53,lng:M[3][0],lat:M[3][1]},year:1985,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥å¤æ–‡åŒ–è¡—%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eæ–‡åŒ–æ—…æ¸¸æ™¯ç‚¹%3C/text%3E%3C/svg%3E"],openingHours:"09:00-21:00",phone:"022-27356433",importance:5,tags:["æ–‡åŒ–æ—…æ¸¸","ä¼ ç»Ÿå•†ä¸š","å¤©æ´¥åœ°æ ‡"],featuredProducts:["æ¨æŸ³é’å¹´ç”»","æ³¥äººå¼ å½©å¡‘","é£Žç­é­é£Žç­","å¤©æ´¥ç‰¹äº§"],honors:["å›½å®¶5Açº§æ—…æ¸¸æ™¯åŒº","ä¸­å›½åŽ†å²æ–‡åŒ–åè¡—","å¤©æ´¥å¸‚æ–‡åŒ–åœ°æ ‡"],historicalSignificance:"å¤©æ´¥å¤æ–‡åŒ–è¡—æ˜¯å¤©æ´¥ä¼ ç»Ÿæ–‡åŒ–çš„é‡è¦è½½ä½“ï¼Œé›†ä¸­å±•ç¤ºäº†å¤©æ´¥çš„åŽ†å²æ–‡åŒ–ã€ä¼ ç»Ÿå·¥è‰ºå’Œæ°‘ä¿—é£Žæƒ…ã€‚",culturalHeritageLevel:"å›½å®¶çº§",relatedPois:[5,6]},{id:12,name:"é£Žç­é­",category:"craft",description:"å¤©æ´¥è‘—åçš„é£Žç­åˆ¶ä½œæŠ€è‰ºï¼Œä»¥åˆ¶ä½œç²¾ç¾Žã€é€ åž‹ç‹¬ç‰¹çš„é£Žç­è€Œé—»åï¼Œæ˜¯ä¸­å›½ä¼ ç»Ÿæ‰‹å·¥è‰ºçš„ä»£è¡¨ã€‚",address:"å¤©æ´¥å¸‚å—å¼€åŒºå¤æ–‡åŒ–è¡—å®«å—å¤§è¡—12å·",position:{x:45,y:54,lng:M[3][0]-.01,lat:M[3][1]-.01},year:1892,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eé£Žç­é­%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eä¼ ç»Ÿæ‰‹å·¥è‰º%3C/text%3E%3C/svg%3E"],openingHours:"09:00-18:00",phone:"022-27356878",importance:4,tags:["ä¼ ç»Ÿæ‰‹å·¥è‰º","å›½å®¶çº§éžé—","å¤©æ´¥åäº§"],featuredProducts:["æ²™ç‡•é£Žç­","å·¨é¾™é£Žç­","è´è¶é£Žç­","äººç‰©é£Žç­"],honors:["å›½å®¶çº§éžç‰©è´¨æ–‡åŒ–é—äº§","ä¸­åŽè€å­—å·","ä¸­å›½ä¼ ç»Ÿå·¥è‰ºçå“"],historicalSignificance:"é£Žç­é­å§‹åˆ›äºŽ1892å¹´ï¼Œç”±é­å…ƒæ³°åˆ›ç«‹ï¼Œå…¶åˆ¶ä½œçš„é£Žç­ä»¥é€ åž‹ç²¾ç¾Žã€å·¥è‰ºç²¾æ¹›ã€æ”¾é£žç¨³å®šè€Œé—»åä¸­å¤–ã€‚",culturalHeritageLevel:"å›½å®¶çº§",relatedPois:[5,6,11]},{id:13,name:"å¤©æ´¥åšç‰©é¦†",category:"culture",description:"å¤©æ´¥æœ€å¤§çš„ç»¼åˆæ€§åšç‰©é¦†ï¼Œæ”¶è—äº†å¤§é‡å¤©æ´¥åŽ†å²æ–‡åŒ–é—äº§ï¼Œæ˜¯äº†è§£å¤©æ´¥åŽ†å²æ–‡åŒ–çš„é‡è¦åœºæ‰€ã€‚",address:"å¤©æ´¥å¸‚æ²³è¥¿åŒºå¹³æ±Ÿé“62å·",position:{x:48,y:59,lng:M[8][0]+.01,lat:M[8][1]+.01},year:1918,images:["data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='800' height='600' viewBox='0 0 800 600'%3E%3Crect width='800' height='600' fill='%23f5f5f5'/%3E%3Ctext x='400' y='300' font-family='Arial' font-size='24' fill='%23333' text-anchor='middle' dy='0.3em'%3Eå¤©æ´¥åšç‰©é¦†%3C/text%3E%3Ctext x='400' y='340' font-family='Arial' font-size='16' fill='%23666' text-anchor='middle' dy='0.3em'%3Eç»¼åˆæ€§åšç‰©é¦†%3C/text%3E%3C/svg%3E"],openingHours:"09:00-16:30ï¼ˆå‘¨ä¸€é—­é¦†ï¼‰",phone:"022-83883000",importance:5,tags:["æ–‡åŒ–è®¾æ–½","åŽ†å²æ–‡ç‰©","å¤©æ´¥åœ°æ ‡"],featuredProducts:["æ–‡ç‰©å±•è§ˆ","åŽ†å²é™ˆåˆ—","ä¸´æ—¶ç‰¹å±•","æ–‡åˆ›äº§å“"],honors:["å›½å®¶ä¸€çº§åšç‰©é¦†","å¤©æ´¥å¸‚çˆ±å›½ä¸»ä¹‰æ•™è‚²åŸºåœ°"],historicalSignificance:"å¤©æ´¥åšç‰©é¦†æ˜¯å¤©æ´¥åŽ†å²æ–‡åŒ–çš„é‡è¦è½½ä½“ï¼Œæ”¶è—äº†å¤§é‡çè´µæ–‡ç‰©ï¼Œå±•ç¤ºäº†å¤©æ´¥ä»Žå¤ä»£åˆ°çŽ°ä»£çš„åŽ†å²å‘å±•è„‰ç»œã€‚",culturalHeritageLevel:"å›½å®¶çº§",relatedPois:[8]}]},_=oe.poi,ge=oe.categories;function Ne(){var g;const{isDark:n,theme:a}=he(),[d,y]=E.useState(1),[w,v]=E.useState("all"),[i,A]=E.useState(null),[j,N]=E.useState(!1),[R,B]=E.useState(()=>{const e={};return _.forEach(o=>{e[o.id]=o.images.map(()=>!1)}),e}),[D,F]=E.useState(0),[I,P]=E.useState(""),[Z,K]=E.useState("all"),L=E.useMemo(()=>{const e=I.toLowerCase(),o=w==="all",b=Z==="all";return _.filter(x=>{const u=o||x.category===w,r=e===""||x.name&&x.name.toLowerCase().includes(e)||x.description&&x.description.toLowerCase().includes(e);return u&&r&&(b||!0)})},[_,w,I,Z]),J=E.useMemo(()=>[],[]),G=E.useMemo(()=>{const e={"bg-yellow-500":"#eab308","bg-blue-500":"#3b82f6","bg-purple-500":"#8b5cf6","bg-red-500":"#ef4444","bg-green-500":"#10b981"};return L.map(o=>{const b=typeof o.position.x=="number"?500+(o.position.x-50)*20:500,x=typeof o.position.y=="number"?500+(o.position.y-50)*20:500,u=ce[o.category]||"bg-blue-500",r=e[u]||"#3b82f6";return{id:o.id.toString(),name:o.name,coordinate:{x:b,y:x},category:o.category,description:o.description,color:r}})},[L]),ie=E.useMemo(()=>[],[]);E.useEffect(()=>{(async()=>{const e=_.map(o=>({poi:o,imageUrl:o.images[0],index:0})).map(({poi:o,imageUrl:b,index:x})=>new Promise(u=>{const r=new Image;r.onload=()=>{B(l=>{const c=[...l[o.id]||Array(o.images.length).fill(!1)];return c[x]=!0,{...l,[o.id]:c}}),u()},r.onerror=()=>{u()},r.src=b}));await Promise.all(e)})()},[]),E.useEffect(()=>{F(0)},[i]);const ee=e=>{A(e),N(!0)},te=E.useCallback(e=>{const o=_.find(b=>b.id.toString()===e);o?ee(o):console.error("æœªæ‰¾åˆ°å¯¹åº”çš„POI:",e)},[_]),q=E.useCallback(()=>{N(!1),A(null)},[]);return t.jsxs("div",{className:`min-h-screen ${n?"bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white":"bg-gradient-to-br from-gray-50 via-white to-gray-100 text-gray-900"}`,children:[t.jsx(xe,{title:"å¤©æ´¥è€å­—å·åŽ†å²åœ°å›¾",subtitle:"æŽ¢ç´¢å¤©æ´¥ç™¾å¹´è€å­—å·çš„åŽ†å²åˆ†å¸ƒä¸Žæ–‡åŒ–ä¼ æ‰¿",theme:"heritage",stats:[{label:"æ–‡åŒ–èµ„æº",value:_.length.toString()},{label:"æ–‡åŒ–åˆ†ç±»",value:Object.keys(ge).length.toString()},{label:"åŽ†å²è·¨åº¦",value:"è¿‘200å¹´"},{label:"æ–‡åŒ–é—äº§",value:"å›½å®¶çº§"}],pattern:!0,size:"lg"}),t.jsxs("main",{className:"container mx-auto px-4 py-8",children:[t.jsx("div",{className:`p-3 md:p-6 rounded-2xl shadow-lg mb-3 md:mb-6 ${n?"bg-gray-800/80 backdrop-blur-sm border border-gray-700":"bg-white/80 backdrop-blur-sm border border-gray-200"}`,children:t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("div",{className:"relative w-full",children:[t.jsx("input",{type:"text",placeholder:"æœç´¢è€å­—å·æˆ–åœ°æ ‡...",value:I,onChange:e=>P(e.target.value),className:`w-full pl-10 pr-10 py-2 rounded-lg border ${n?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-100 border-gray-300 text-gray-900 placeholder-gray-500"} focus:outline-none focus:ring-2 focus:ring-red-500 transition-all duration-300`}),t.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),I&&t.jsx("button",{onClick:()=>P(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:t.jsx("i",{className:"fas fa-times"})})]}),t.jsx("div",{className:"flex flex-wrap items-center justify-between gap-3 pt-1",children:t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsx("button",{className:`px-3 py-1.5 rounded-full text-xs md:text-sm font-medium transition-all duration-300 ease-in-out transform hover:scale-105 shadow-md hover:shadow-lg ${w==="all"?n?"bg-gradient-to-r from-red-600 to-red-700 text-white":"bg-gradient-to-r from-red-500 to-red-600 text-white":n?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"} border border-transparent hover:border-opacity-50`,onClick:()=>v("all"),children:"å…¨éƒ¨"}),Object.entries(ge).map(([e,o])=>{const b=o.color.replace("bg-","");return t.jsxs("button",{className:`px-3 py-1.5 rounded-full text-xs md:text-sm font-medium transition-all duration-300 ease-in-out transform hover:scale-105 shadow-md hover:shadow-lg flex items-center gap-1.5 ${w===e?(n?`bg-gradient-to-r from-${b}/80 to-${b}`:`bg-gradient-to-r from-${b} to-${b}/80`)+" text-white":n?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"} border border-transparent hover:border-opacity-50`,onClick:()=>v(e),children:[t.jsx("span",{className:"text-base",children:o.icon})," ",t.jsx("span",{className:"hidden sm:inline",children:o.name})]},e)})]})})]})}),t.jsxs("div",{className:"relative w-full rounded-2xl shadow-xl overflow-hidden bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-900 border border-gray-100 dark:border-gray-700",style:{height:"800px",minHeight:"500px",maxHeight:"calc(100vh - 100px)"},children:[t.jsx(Ee,{initialRegions:J,initialPOIs:G,initialPaths:ie,onPOIClick:te,onMapClick:q,className:`${n?"bg-gray-800/80 backdrop-blur-sm":"bg-white/80 backdrop-blur-sm"}`,style:{height:"100%",width:"100%"}}),j&&i&&t.jsxs(me.div,{className:`absolute bottom-0 left-0 right-0 md:bottom-4 md:left-4 md:right-auto md:w-80 lg:w-96 bg-white dark:bg-gray-800 rounded-t-xl md:rounded-xl shadow-2xl border-t md:border ${n?"border-gray-700":"border-gray-200"} overflow-hidden z-50 max-h-[70vh] md:max-h-[90vh]`,initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{duration:.4,ease:"easeOut"},children:[t.jsxs("div",{className:"relative h-52 overflow-hidden bg-gray-200 dark:bg-gray-700",children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent z-10"}),i.images.map((e,o)=>t.jsx("img",{src:e,alt:`${i.name} - å›¾ç‰‡ ${o+1}`,className:`absolute inset-0 w-full h-full object-cover transition-transform duration-500 hover:scale-110 ${o===D?"opacity-100":"opacity-0"}`,onLoad:()=>{B(b=>{const x=[...b[i.id]||Array(i.images.length).fill(!1)];return x[o]=!0,{...b,[i.id]:x}})},onError:b=>{const x=b.target;x.src=`data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300' viewBox='0 0 400 300'%3E%3Crect width='400' height='300' fill='%23${n?"374151":"e5e7eb"}'/%3E%3Ctext x='200' y='150' font-family='Arial' font-size='20' fill='%23${n?"9ca3af":"6b7280"}' text-anchor='middle' dy='0.3em'%3E${i.name}%3C/text%3E%3Ctext x='200' y='180' font-family='Arial' font-size='14' fill='%23${n?"9ca3af":"6b7280"}' text-anchor='middle' dy='0.3em'%3Eå›¾ç‰‡åŠ è½½ä¸­...%3C/text%3E%3C/svg%3E`,x.alt=`${i.name} å›¾ç‰‡`,B(u=>{const r=[...u[i.id]||Array(i.images.length).fill(!1)];return r[o]=!0,{...u,[i.id]:r}})},style:{display:"block"}},o)),t.jsxs("div",{className:"absolute top-3 left-3 bg-black/80 text-white text-xs px-3 py-1 rounded-full backdrop-blur-sm flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-calendar-alt text-xs"}),i.year," å¹´"]}),i.images.length>1&&t.jsxs(t.Fragment,{children:[t.jsx("button",{className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 backdrop-blur-sm z-20",onClick:()=>F(e=>(e-1+i.images.length)%i.images.length),children:t.jsx("i",{className:"fas fa-chevron-left text-sm"})}),t.jsx("button",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-black/50 hover:bg-black/70 text-white w-8 h-8 rounded-full flex items-center justify-center transition-all duration-300 backdrop-blur-sm z-20",onClick:()=>F(e=>(e+1)%i.images.length),children:t.jsx("i",{className:"fas fa-chevron-right text-sm"})}),t.jsx("div",{className:"absolute bottom-3 left-1/2 transform -translate-x-1/2 flex gap-1.5 z-20",children:i.images.map((e,o)=>t.jsx("button",{className:`w-2 h-2 rounded-full transition-all duration-300 ${o===D?"bg-white w-6":"bg-white/50 hover:bg-white/70"}`,onClick:()=>F(o)},o))})]})]}),t.jsxs("div",{className:"p-5 overflow-y-auto max-h-[calc(80vh-130px)] md:max-h-[calc(90vh-130px)]",children:[t.jsx("h3",{className:"text-2xl font-bold mb-2 dark:text-white",children:i.name}),i.importance&&t.jsxs("div",{className:"mb-3 flex items-center gap-1",children:[Array.from({length:5}).map((e,o)=>t.jsx("i",{className:`fas fa-star ${o<i.importance?"text-yellow-500":"text-gray-300 dark:text-gray-600"} text-sm`},o)),t.jsx("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["","ä¸€èˆ¬","é‡è¦","å¾ˆé‡è¦","éžå¸¸é‡è¦","æžå…¶é‡è¦"][i.importance]||""})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4",children:[t.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-medium ${n?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:[de[i.category]," ",((g=oe.categories[i.category])==null?void 0:g.name)||"å…¶ä»–"]}),t.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-map-marker-alt text-xs"}),i.address]})]}),i.tags&&i.tags.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:i.tags.map((e,o)=>t.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${n?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"} hover:opacity-80 transition-opacity`,children:["#",e]},o))}),t.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-3 mb-5 p-4 rounded-xl ${n?"bg-gray-700/50":"bg-gray-50"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n?"bg-blue-900/30 text-blue-400":"bg-blue-100 text-blue-800"}`,children:t.jsx("i",{className:"fas fa-calendar-alt text-xs"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"åˆ›ç«‹æ—¶é—´"}),t.jsxs("div",{className:"text-sm font-semibold dark:text-white",children:[i.year," å¹´"]})]})]}),i.openingHours&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n?"bg-green-900/30 text-green-400":"bg-green-100 text-green-800"}`,children:t.jsx("i",{className:"fas fa-clock text-xs"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"å¼€æ”¾æ—¶é—´"}),t.jsx("div",{className:"text-sm font-semibold dark:text-white",children:i.openingHours})]})]}),i.phone&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n?"bg-purple-900/30 text-purple-400":"bg-purple-100 text-purple-800"}`,children:t.jsx("i",{className:"fas fa-phone text-xs"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"è”ç³»ç”µè¯"}),t.jsx("div",{className:"text-sm font-semibold dark:text-white",children:i.phone})]})]}),i.culturalHeritageLevel&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${n?"bg-yellow-900/30 text-yellow-400":"bg-yellow-100 text-yellow-800"}`,children:t.jsx("i",{className:"fas fa-award text-xs"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"é—äº§çº§åˆ«"}),t.jsx("div",{className:"text-sm font-semibold dark:text-white",children:i.culturalHeritageLevel})]})]})]}),t.jsxs("div",{className:"mb-5",children:[t.jsxs("h4",{className:"text-sm font-semibold mb-2 dark:text-white flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-history text-gray-500 dark:text-gray-400"}),"åŽ†å²èƒŒæ™¯"]}),t.jsx("p",{className:"text-sm dark:text-gray-300 leading-relaxed",children:i.description})]}),i.historicalSignificance&&t.jsxs("div",{className:"mb-5",children:[t.jsxs("h4",{className:"text-sm font-semibold mb-2 dark:text-white flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-book text-gray-500 dark:text-gray-400"}),"åŽ†å²æ„ä¹‰"]}),t.jsx("p",{className:"text-sm dark:text-gray-300 leading-relaxed",children:i.historicalSignificance})]}),i.featuredProducts&&i.featuredProducts.length>0&&t.jsxs("div",{className:"mb-5",children:[t.jsxs("h4",{className:"text-sm font-semibold mb-2 dark:text-white flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-gift text-gray-500 dark:text-gray-400"}),"ç‰¹è‰²äº§å“"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:i.featuredProducts.map((e,o)=>t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${n?"bg-green-900/30 text-green-400 hover:bg-green-800/30":"bg-green-100 text-green-800 hover:bg-green-200"} hover:opacity-80 transition-all duration-300`,children:e},o))})]}),i.honors&&i.honors.length>0&&t.jsxs("div",{className:"mb-5",children:[t.jsxs("h4",{className:"text-sm font-semibold mb-2 dark:text-white flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-trophy text-gray-500 dark:text-gray-400"}),"è£èª‰èµ„è´¨"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:(i.honors||[]).map((e,o)=>t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${n?"bg-blue-900/30 text-blue-400 hover:bg-blue-800/30":"bg-blue-100 text-blue-800 hover:bg-blue-200"} hover:opacity-80 transition-all duration-300`,children:e},`honor-${o}`))})]}),i.relatedPois&&i.relatedPois.length>0&&t.jsxs("div",{className:"mb-5",children:[t.jsxs("h4",{className:"text-sm font-semibold mb-2 dark:text-white flex items-center gap-1",children:[t.jsx("i",{className:"fas fa-compass text-gray-500 dark:text-gray-400"}),"ç›¸å…³æŽ¨è"]}),t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:i.relatedPois.map(e=>{var o;const b=_.find(x=>x.id===e);return b?t.jsxs("button",{className:`px-3 py-2 rounded-lg text-sm font-medium flex items-center gap-2 ${n?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200 text-gray-700"} transition-all duration-300 hover:shadow-md`,onClick:()=>ee(b),children:[t.jsx("span",{className:`text-lg ${ce[b.category]}`,children:de[b.category]}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium truncate",children:b.name}),t.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:(o=oe.categories[b.category])==null?void 0:o.name})]}),t.jsx("i",{className:"fas fa-chevron-right text-xs text-gray-400 dark:text-gray-500"})]},b.id):null})})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{className:`flex-1 py-2 rounded-lg transition-all duration-300 ${n?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"} font-medium text-sm flex items-center justify-center gap-1 shadow-md hover:shadow-lg transform hover:-translate-y-0.5`,onClick:()=>N(!1),children:[t.jsx("i",{className:"fas fa-times"}),"å…³é—­"]}),t.jsxs("button",{className:`flex-1 py-2 rounded-lg transition-all duration-300 ${n?"bg-gray-700 hover:bg-gray-600 text-gray-300":"bg-gray-200 hover:bg-gray-300 text-gray-700"} font-medium text-sm flex items-center justify-center gap-1 shadow-md hover:shadow-lg transform hover:-translate-y-0.5`,children:[t.jsx("i",{className:"fas fa-share-alt"}),"åˆ†äº«"]})]}),t.jsxs("button",{className:`w-full mt-3 py-2 rounded-lg transition-all duration-300 ${n?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"} font-medium text-sm flex items-center justify-center gap-1 shadow-md hover:shadow-lg transform hover:-translate-y-0.5`,onClick:()=>window.open("/AR","_blank","width=1000,height=800"),children:[t.jsx("i",{className:"fas fa-vr-cardboard"}),"ARä½“éªŒ"]})]})]})]}),t.jsxs("div",{className:`p-6 rounded-2xl shadow-lg mt-6 ${n?"bg-gray-800/80 backdrop-blur-sm border border-gray-700":"bg-white/80 backdrop-blur-sm border border-gray-200"}`,children:[t.jsx("h3",{className:"text-xl font-bold mb-4",children:"åœ°å›¾ä½¿ç”¨è¯´æ˜Ž"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("i",{className:"fas fa-mouse-pointer text-red-500 mt-1"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:"ç‚¹å‡»æ ‡è®°"}),t.jsx("p",{className:"text-sm dark:text-gray-400",children:"ç‚¹å‡»åœ°å›¾ä¸Šçš„æ ‡è®°ç‚¹æŸ¥çœ‹è€å­—å·è¯¦ç»†ä¿¡æ¯"})]})]}),t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("i",{className:"fas fa-filter text-blue-500 mt-1"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:"åˆ†ç±»ç­›é€‰"}),t.jsx("p",{className:"text-sm dark:text-gray-400",children:"ä½¿ç”¨é¡¶éƒ¨åˆ†ç±»æŒ‰é’®ç­›é€‰ä¸åŒç±»åž‹çš„è€å­—å·"})]})]}),t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("i",{className:"fas fa-search-plus text-green-500 mt-1"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:"ç¼©æ”¾æŽ§åˆ¶"}),t.jsx("p",{className:"text-sm dark:text-gray-400",children:"ä½¿ç”¨é¼ æ ‡æ»šè½®æˆ–åœ°å›¾æŽ§ä»¶è°ƒæ•´åœ°å›¾å¤§å°"})]})]}),t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("i",{className:"fas fa-info-circle text-purple-500 mt-1"}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold",children:"äº†è§£åŽ†å²"}),t.jsx("p",{className:"text-sm dark:text-gray-400",children:"æŽ¢ç´¢å¤©æ´¥è€å­—å·çš„ç™¾å¹´åŽ†å²ä¸Žæ–‡åŒ–ä¼ æ‰¿"})]})]})]})]})]})]})}export{Ne as default};
