import{aD as se,C as n,aE as re,aB as N,c as e,az as j,b0 as F,ay as A}from"./index-DvRCDgMZ.js";var le=Object.defineProperty,ne=(y,i,t)=>i in y?le(y,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):y[i]=t,S=(y,i,t)=>ne(y,typeof i!="symbol"?i+"":i,t);class de{constructor(){S(this,"cards",[]),S(this,"levels",[]),S(this,"gameProgress",new Map),S(this,"nextCardId",1),S(this,"nextLevelId",1),this.initCards(),this.initLevels()}initCards(){this.cards=[{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Yangliuqing%20New%20Year%20Painting%20traditional%20Chinese%20art",name:"杨柳青年画",description:"中国四大木版年画之一，以色彩鲜艳、构图饱满著称",culturalElement:"传统绘画",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Nirenzhang%20clay%20sculpture%20traditional%20Chinese%20art",name:"泥人张彩塑",description:"天津传统民间艺术，以细腻的造型和生动的表情著称",culturalElement:"传统雕塑",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Tianjin%20crosstalk%20performance%20traditional%20Chinese%20art",name:"天津相声",description:"中国北方传统曲艺形式，以幽默风趣的对话著称",culturalElement:"传统曲艺",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Tianjin%20mahua%20traditional%20Chinese%20snack",name:"天津麻花",description:"天津传统名点，以酥脆香甜著称",culturalElement:"传统美食",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Goubuli%20steamed%20buns%20traditional%20Chinese%20food",name:"狗不理包子",description:"天津传统名点，以皮薄馅大、鲜香可口著称",culturalElement:"传统美食",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Tianjin%20dialect%20conversation%20illustration",name:"天津方言",description:"天津地区的方言，以幽默风趣、表现力强著称",culturalElement:"方言文化",category:"天津文化"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Beijing%20Opera%20face%20paint%20traditional%20Chinese%20art",name:"京剧脸谱",description:"京剧艺术的重要组成部分，以色彩象征人物性格",culturalElement:"传统戏曲",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20calligraphy%20art%20traditional%20writing",name:"书法艺术",description:"中国传统艺术形式，以毛笔书写汉字为表现手段",culturalElement:"传统书画",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Traditional%20Chinese%20patterns%20cloud%20design",name:"传统纹样",description:"中国传统装饰图案，具有丰富的文化内涵",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20knot%20traditional%20decorative%20art",name:"中国结",description:"中国传统手工艺品，象征吉祥如意",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20paper%20cutting%20art%20traditional%20craft",name:"剪纸艺术",description:"中国传统民间艺术，以剪刀或刻刀在纸上剪刻花纹",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Blue%20and%20white%20porcelain%20traditional%20Chinese%20ceramics",name:"青花瓷",description:"中国传统瓷器品种，以青花为装饰手法",culturalElement:"传统工艺",category:"传统艺术"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20dragon%20symbol%20traditional%20culture",name:"龙",description:"中国传统文化中的祥瑞动物，象征权力和尊贵",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20phoenix%20symbol%20traditional%20culture",name:"凤",description:"中国传统文化中的祥瑞动物，象征吉祥和美好",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Chinese%20character%20Fu%20symbol%20good%20luck",name:"福字",description:"中国传统文化中的吉祥符号，象征幸福和福气",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Traditional%20Chinese%20cloud%20pattern%20design",name:"祥云",description:"中国传统文化中的吉祥图案，象征祥瑞和好运",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Bagua%20symbol%20traditional%20Chinese%20philosophy",name:"八卦",description:"中国传统文化中的哲学符号，象征宇宙万物的变化规律",culturalElement:"文化符号",category:"文化符号"},{id:`card-${this.nextCardId++}`,imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=512x512&prompt=Taiji%20symbol%20yin%20yang%20traditional%20Chinese%20philosophy",name:"太极",description:"中国传统文化中的哲学符号，象征阴阳对立统一",culturalElement:"文化符号",category:"文化符号"}]}initLevels(){const i=(t,s=2)=>{const m=t.map(p=>this.cards[p-1]),o=[];for(const p of m)for(let b=0;b<s;b++)o.push({...p,id:`${p.id}-copy-${b}`});return o};this.levels=[{id:`level-${this.nextLevelId++}`,name:"天津文化入门",description:"了解天津的传统特色文化元素",cards:i([1,2,3,4]),gridSize:{rows:4,cols:4},difficulty:"easy",reward:"解锁天津文化素材包",culturalTheme:"天津地方文化",imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Tianjin%20cultural%20heritage%20tourism"},{id:`level-${this.nextLevelId++}`,name:"传统艺术探索",description:"探索中国传统艺术形式",cards:i([7,8,9,10,11,12]),gridSize:{rows:6,cols:4},difficulty:"medium",unlockCondition:{type:"level",value:1},reward:"解锁传统纹样素材包",culturalTheme:"中国传统艺术",imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Chinese%20traditional%20art%20collection"},{id:`level-${this.nextLevelId++}`,name:"文化符号挑战",description:"挑战识别中国文化符号",cards:i([13,14,15,16,17,18,1,2]),gridSize:{rows:4,cols:8},difficulty:"hard",unlockCondition:{type:"level",value:2},reward:"解锁高级配色方案",culturalTheme:"中国文化符号",imageUrl:"https://trae-api-sg.mchost.guru/api/ide/v1/text_to_image?image_size=1024x1024&prompt=Chinese%20cultural%20symbols%20collection"}]}getLevels(){return[...this.levels]}getLevelById(i){return this.levels.find(t=>t.id===i)}getCards(){return[...this.cards]}getCardById(i){const t=i.split("-copy-")[0];return this.cards.find(s=>s.id===t)}getGameProgress(i){if(!this.gameProgress.has(i)){const t={userId:i,completedLevels:[],totalScore:0,levelScores:{},unlockedHints:3,bestTimes:{},lastPlayed:new Date};this.gameProgress.set(i,t)}return this.gameProgress.get(i)}updateGameProgress(i,t){const s={...this.getGameProgress(i),...t,lastPlayed:new Date};return this.gameProgress.set(i,s),s}checkMatch(i,t){const s=i.id.split("-copy-")[0],m=t.id.split("-copy-")[0];return s===m}calculateScore(i,t,s){const m=i*10,o={easy:.3,medium:.5,hard:.8}[s]||.5,p=Math.max(0,600-t)*o,b={easy:1,medium:1.2,hard:1.5}[s]||1;return Math.round((m+p)*b)}completeLevel(i,t,s,m){const o=this.getGameProgress(i),p={...o.bestTimes};(!p[t]||m<p[t])&&(p[t]=m);const b={...o,completedLevels:[...new Set([...o.completedLevels,t])],totalScore:o.totalScore+s,levelScores:{...o.levelScores,[t]:s},bestTimes:p,lastPlayed:new Date};return this.gameProgress.set(i,b),b}useHint(i){const t=this.getGameProgress(i);return t.unlockedHints>0?(this.updateGameProgress(i,{unlockedHints:t.unlockedHints-1}),!0):!1}unlockHint(i){const t=this.getGameProgress(i);this.updateGameProgress(i,{unlockedHints:t.unlockedHints+1})}isLevelUnlocked(i,t){const s=this.getLevelById(t);if(!s||!s.unlockCondition)return!0;const m=this.getGameProgress(i),{unlockCondition:o}=s;return o.type==="level"?m.completedLevels.length>=o.value:o.type==="score"?m.totalScore>=o.value:!1}shuffleCards(i){const t=[...i];for(let s=t.length-1;s>0;s--){const m=Math.floor(Math.random()*(s+1));[t[s],t[m]]=[t[m],t[s]]}return t}}const h=new de,ge=({isOpen:y,onClose:i})=>{const{isDark:t}=se(),{user:s}=n.useContext(re),[m,o]=n.useState("menu"),[p,b]=n.useState([]),[c,Y]=n.useState(null),[u,E]=n.useState(null),[C,w]=n.useState([]),[O,I]=n.useState([]),[_,H]=n.useState(0),[q,L]=n.useState(0),[$,V]=n.useState(null),[K,M]=n.useState(null),[k,G]=n.useState(!1),[ce,z]=n.useState(!1),[oe,U]=n.useState([]),[T,J]=n.useState(!0);n.useEffect(()=>{if(y){J(!0);const a=h.getLevels();if(b(a),s){const r=h.getGameProgress(s.id);E(r)}J(!1)}},[y,s]);const P=n.useCallback(a=>{Y(a),o("playing"),H(0),L(0),V(new Date),M(null),G(!0),z(!1),U([]),I([]);const r=h.shuffleCards(a.cards).map(l=>({card:l,isFlipped:!1,isMatched:!1,isHinted:!1}));w(r)},[]),Q=n.useCallback(a=>{!k||O.length>=2||(w(r=>{const l=[...r];return l[a].isFlipped||l[a].isMatched||(l[a].isFlipped=!0),l}),I(r=>{const l=[...r,C[a]];return l.length===2&&setTimeout(()=>X(l),1e3),l}))},[k,O,C]),X=n.useCallback(a=>{if(a.length!==2)return;const[r,l]=a;h.checkMatch(r.card,l.card)?(w(g=>{const d=[...g],x=d.findIndex(v=>v.card.id===r.card.id),f=d.findIndex(v=>v.card.id===l.card.id);return x!==-1&&(d[x].isMatched=!0,d[x].isHinted=!1),f!==-1&&(d[f].isMatched=!0,d[f].isHinted=!1),d}),H(g=>g+1),N.success("匹配成功！")):(w(g=>{const d=[...g],x=d.findIndex(v=>v.card.id===r.card.id),f=d.findIndex(v=>v.card.id===l.card.id);return x!==-1&&(d[x].isFlipped=!1,d[x].isHinted=!1),f!==-1&&(d[f].isFlipped=!1,d[f].isHinted=!1),d}),N.error("匹配失败，再试一次！")),I([]),z(!1),U([])},[]),W=n.useCallback(()=>{if(!(!s||!u))if(h.useHint(s.id)){const a=C.filter(g=>!g.isMatched&&!g.isFlipped);if(a.length<2){N.info("没有可提示的卡片了！");return}let r=null,l=null;for(let g=0;g<a.length;g++){for(let d=g+1;d<a.length;d++)if(h.checkMatch(a[g].card,a[d].card)){r=a[g],l=a[d];break}if(r&&l)break}if(r&&l){w(d=>{const x=[...d],f=x.findIndex(D=>D.card.id===(r==null?void 0:r.card.id)),v=x.findIndex(D=>D.card.id===(l==null?void 0:l.card.id));return f!==-1&&(x[f].isHinted=!0),v!==-1&&(x[v].isHinted=!0),x}),z(!0),U([r,l]),N.success("已显示提示卡片！");const g=h.getGameProgress(s.id);E(g)}}else N.error("提示次数已用完！")},[s,u,C]),R=n.useCallback(()=>{if(!s||!c)return;const a=$?Math.round((new Date().getTime()-$.getTime())/1e3):0;M(a);const r=h.calculateScore(_,a,c.difficulty);L(r);const l=h.completeLevel(s.id,c.id,r,a);E(l),o("completed"),G(!1),N.success(`关卡完成！得分：${r}`)},[s,c,_,$]);n.useEffect(()=>{if(c&&C.length>0){const a=c.cards.length/2;_===a&&k&&R()}},[_,c,C.length,k,R]);const ee=n.useCallback(a=>{if(!s){N.error("请先登录！");return}h.isLevelUnlocked(s.id,a.id)?P(a):N.error("该关卡尚未解锁！")},[s,P]),Z=n.useCallback(()=>{o("menu"),Y(null),w([]),I([]),H(0),L(0),V(null),M(null),G(!1),z(!1),U([])},[]),te=n.useCallback(()=>{c&&P(c)},[c,P]),B=n.useCallback(a=>{if(!a)return"00:00";const r=Math.floor(a/60),l=a%60;return`${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},[]),[ae,ie]=n.useState(0);return n.useEffect(()=>{let a;return $&&k&&(a=setInterval(()=>{const r=Math.round((new Date().getTime()-$.getTime())/1e3);ie(r)},1e3)),()=>clearInterval(a)},[$,k]),y?e.jsx(j.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.3},className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4 overflow-y-auto",onClick:a=>a.target===a.currentTarget&&i(),children:e.jsxs(j.div,{initial:{scale:.9,y:50},animate:{scale:1,y:0},exit:{scale:.9,y:50},transition:{type:"spring",stiffness:300,damping:30},className:`w-full max-w-6xl rounded-xl overflow-hidden shadow-2xl ${t?"bg-gray-800":"bg-white"} text-${t?"white":"gray-900"}`,onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:`p-4 border-b ${t?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-xl font-bold",children:"文化元素连连看"}),e.jsx("button",{onClick:i,className:`p-2 rounded-full ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-6",children:[T&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-red-600 mb-4"}),e.jsx("p",{className:"text-lg",children:"加载游戏数据..."})]}),e.jsx(F,{mode:"wait",children:m==="menu"&&!T&&e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"欢迎来到文化元素连连看"}),e.jsx("p",{className:`${t?"text-gray-400":"text-gray-600"}`,children:"通过匹配相同的文化元素卡片，了解中国传统文化和天津地方特色"})]}),u&&e.jsxs("div",{className:`mb-6 p-4 rounded-lg ${t?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"游戏进度"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"已完成关卡"}),e.jsx("p",{className:"text-xl font-bold",children:u.completedLevels.length})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"总得分"}),e.jsx("p",{className:"text-xl font-bold",children:u.totalScore})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"可用提示"}),e.jsx("p",{className:"text-xl font-bold",children:u.unlockedHints})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"关卡总数"}),e.jsx("p",{className:"text-xl font-bold",children:p.length})]})]})]}),e.jsx("h3",{className:"text-lg font-medium mb-4",children:"选择关卡"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(a=>{const r=(u==null?void 0:u.completedLevels.includes(a.id))||!1,l=!s||h.isLevelUnlocked(s.id,a.id);return e.jsxs(j.div,{className:`p-4 rounded-lg border cursor-pointer transition-all ${t?"border-gray-700":"border-gray-200"} ${l?"hover:shadow-md":"opacity-50 cursor-not-allowed"}`,whileHover:l?{y:-4}:{},onClick:()=>l&&ee(a),children:[a.imageUrl&&e.jsxs("div",{className:"relative aspect-video overflow-hidden rounded-lg mb-3",children:[e.jsx(A,{src:a.imageUrl,alt:a.name,className:"w-full h-full object-cover transition-transform hover:scale-105",ratio:"landscape",fit:"cover"}),r&&e.jsx("div",{className:"absolute top-2 right-2 bg-green-600 text-white text-xs px-2 py-1 rounded-full",children:"已完成"}),!l&&e.jsx("div",{className:"absolute top-2 right-2 bg-gray-600 text-white text-xs px-2 py-1 rounded-full",children:"未解锁"})]}),e.jsx("h4",{className:"font-medium mb-1",children:a.name}),e.jsx("p",{className:`text-sm mb-2 ${t?"text-gray-400":"text-gray-600"}`,children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:a.difficulty.toUpperCase()}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:[a.gridSize.rows,"x",a.gridSize.cols]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-gray-700":"bg-gray-100"}`,children:a.culturalTheme})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs font-medium",children:[a.cards.length/2," 对卡片"]}),e.jsxs("span",{className:`text-xs px-2 py-0.5 rounded-full ${t?"bg-yellow-900 bg-opacity-30 text-yellow-200":"bg-yellow-100 text-yellow-800"}`,children:["奖励: ",a.reward]})]})]},a.id)})})]},"menu")}),e.jsx(F,{mode:"wait",children:m==="playing"&&c&&!T&&e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h3",{className:"text-lg font-medium",children:c.name}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Z,className:`px-3 py-1 rounded-lg text-sm transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"返回菜单"}),e.jsxs("button",{onClick:W,disabled:!u||u.unlockedHints<=0,className:`px-3 py-1 rounded-lg text-sm transition-colors ${t?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white disabled:opacity-50 disabled:cursor-not-allowed`,children:[e.jsx("i",{className:"fas fa-lightbulb mr-1"}),"提示 (",(u==null?void 0:u.unlockedHints)||0,")"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:`p-2 rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs block mb-1",children:"匹配进度"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:_}),e.jsxs("span",{className:"text-xs",children:["/ ",c.cards.length/2," 对"]})]})]}),e.jsxs("div",{className:`p-2 rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs block mb-1",children:"当前得分"}),e.jsx("span",{className:"font-medium",children:q})]}),e.jsxs("div",{className:`p-2 rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,children:[e.jsx("span",{className:"text-xs block mb-1",children:"用时"}),e.jsx("span",{className:"font-medium",children:B(ae)})]})]})]}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"grid gap-2",style:{gridTemplateColumns:`repeat(${c.gridSize.cols}, minmax(60px, 100px))`,gridTemplateRows:`repeat(${c.gridSize.rows}, minmax(60px, 100px))`},children:C.map((a,r)=>e.jsx(j.div,{className:"relative w-full h-full perspective",onClick:()=>Q(r),children:e.jsx(j.div,{className:`w-full h-full rounded-lg overflow-hidden cursor-pointer ${a.isMatched?"opacity-0":"opacity-100"}`,animate:{opacity:a.isMatched?0:1,scale:a.isMatched?.8:1},transition:{duration:.3},children:e.jsxs(j.div,{className:"relative w-full h-full transition-transform duration-500 transform-style-3d",animate:{rotateY:a.isFlipped?180:0},style:{transformStyle:"preserve-3d"},children:[e.jsx("div",{className:`absolute inset-0 backface-hidden flex items-center justify-center rounded-lg ${t?"bg-gray-700":"bg-gray-100"}`,style:{backfaceVisibility:"hidden"},children:e.jsx("i",{className:"fas fa-question text-2xl"})}),e.jsxs("div",{className:`absolute inset-0 backface-hidden flex flex-col items-center justify-center p-2 rounded-lg ${t?"bg-gray-800 border border-gray-700":"bg-white border border-gray-200"} ${a.isHinted?"ring-2 ring-yellow-500":""}`,style:{backfaceVisibility:"hidden",transform:"rotateY(180deg)"},children:[e.jsx(A,{src:a.card.imageUrl,alt:a.card.name,className:"w-full h-24 object-cover rounded mb-2",ratio:"auto",fit:"cover",priority:!0}),e.jsx("span",{className:"text-xs font-medium text-center",children:a.card.name})]})]})})},a.card.id))})})]},"playing")}),e.jsx(F,{mode:"wait",children:m==="completed"&&c&&u&&!T&&e.jsxs(j.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"text-center",children:[e.jsx(j.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:260,damping:20},className:"mb-6",children:e.jsx("i",{className:"fas fa-trophy text-6xl text-yellow-500"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"恭喜完成关卡！"}),e.jsxs("p",{className:`mb-6 ${t?"text-gray-400":"text-gray-600"}`,children:["你成功完成了「",c.name,"」关卡"]}),e.jsx("div",{className:`p-4 rounded-lg mb-6 ${t?"bg-gray-700":"bg-gray-50"}`,children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"最终得分"}),e.jsx("p",{className:"text-xl font-bold",children:q})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"完成时间"}),e.jsx("p",{className:"text-xl font-bold",children:B(K||0)})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"匹配对数"}),e.jsxs("p",{className:"text-xl font-bold",children:[_," / ",c.cards.length/2]})]}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm ${t?"text-gray-400":"text-gray-600"}`,children:"历史最佳"}),e.jsx("p",{className:"text-xl font-bold",children:u.bestTimes[c.id]?B(u.bestTimes[c.id]):"-"})]})]})}),e.jsxs("div",{className:`p-4 rounded-lg mb-6 ${t?"bg-yellow-900 bg-opacity-30":"bg-yellow-100"} border ${t?"border-yellow-700":"border-yellow-200"}`,children:[e.jsx("h3",{className:"font-medium mb-2",children:"获得奖励"}),e.jsx("p",{className:t?"text-yellow-200":"text-yellow-800",children:c.reward})]}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{onClick:te,className:`px-4 py-2 rounded-lg transition-colors ${t?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,children:"重新挑战"}),e.jsx("button",{onClick:Z,className:`px-4 py-2 rounded-lg transition-colors ${t?"bg-blue-600 hover:bg-blue-700":"bg-blue-500 hover:bg-blue-600"} text-white`,children:"返回关卡选择"})]})]},"completed")})]})]})}):null};export{ge as default};
