import{aD as Ye,C as l,aJ as m,c as e,az as y,aZ as N,aB as _}from"./index-DvRCDgMZ.js";const Be=({isOpen:w,onClose:k})=>{const{isDark:r}=Ye(),[d,z]=l.useState(m.getCurrentModel()),[n,x]=l.useState(m.getConfig()),[I,W]=l.useState(!1),[i,b]=l.useState(!1),[M,f]=l.useState(null),[G,O]=l.useState([]),[p,T]=l.useState(m.getCurrentRole()),[De,qe]=l.useState(!1),$=l.useRef(null),[j,H]=l.useState(!1),[h,E]=l.useState([m.getCurrentModel().id]),[S,Re]=l.useState(()=>localStorage.getItem("KIMI_API_KEY")||""||""),[Z,B]=l.useState("https://api.moonshot.cn/v1"),[U,L]=l.useState("moonshot-v1-32k"),[C,ze]=l.useState(()=>localStorage.getItem("DEEPSEEK_API_KEY")||""||""),[Q,V]=l.useState("https://api.deepseek.com"),[X,J]=l.useState("deepseek-chat"),[K,Me]=l.useState(()=>localStorage.getItem("DOUBAO_API_KEY")||""||""),[ee,te]=l.useState("https://api.doubao.com/v1"),[ae,se]=l.useState("doubao-pro-32k"),[P,Ge]=l.useState(()=>localStorage.getItem("WENXIN_API_KEY")||""||""),[re,le]=l.useState("https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions"),[ne,ie]=l.useState("ERNIE-Speed-8K"),[A,Te]=l.useState(()=>localStorage.getItem("QWEN_API_KEY")||""||""),[de,oe]=l.useState("https://dashscope.aliyuncs.com/api/v1"),[ce,me]=l.useState("qwen-plus"),[Y,Fe]=l.useState(()=>localStorage.getItem("CHATGPT_API_KEY")||""||""),[xe,ge]=l.useState("https://api.openai.com/v1"),[ue,pe]=l.useState("gpt-4o"),[D,We]=l.useState(()=>localStorage.getItem("GEMINI_API_KEY")||""||""),[he,be]=l.useState("https://generativelanguage.googleapis.com/v1"),[ye,je]=l.useState("gemini-1.5-flash"),[q,Oe]=l.useState(()=>localStorage.getItem("GORK_API_KEY")||""||""),[fe,ve]=l.useState("https://api.x.ai/v1"),[Ne,_e]=l.useState("grok-beta"),[R,He]=l.useState(()=>localStorage.getItem("ZHIPU_API_KEY")||""||""),[we,ke]=l.useState("https://open.bigmodel.cn/api/paas/v4"),[Ie,$e]=l.useState("glm-4-plus"),F=l.useRef(null);l.useEffect(()=>{if(w){const t=m.getCurrentModel();z(t),x(m.getConfig());const a=m.getRoles();O(a),T(m.getCurrentRole()),E([t.id])}},[w]);const Ee=()=>{H(!j),j&&h.length===0&&E([m.getCurrentModel().id])},Se=t=>{E(a=>{if(a.includes(t)){const s=a.filter(g=>g!==t);return s.length>0?s:[t]}else return[...a,t]})},Ce=t=>{const a=G.find(s=>s.id===t);a&&(T(a),setTimeout(()=>{$.current&&$.current.scrollIntoView({behavior:"smooth",block:"start"})},50))},v=t=>{const a=N.find(s=>s.id===t);a&&(z(a),setTimeout(()=>{F.current&&F.current.scrollIntoView({behavior:"smooth",block:"start"})},50))},Ke=(t,a)=>{const s=N.map(g=>g.id);if(t.key==="Enter"||t.key===" ")t.preventDefault(),v(s[a]);else if(t.key==="ArrowRight"){t.preventDefault();const g=(a+1)%s.length;v(s[g])}else if(t.key==="ArrowLeft"){t.preventDefault();const g=(a-1+s.length)%s.length;v(s[g])}},o=(t,a)=>{x(s=>({...s,[t]:a}))},u=(t,a)=>{if(!a)return!0;switch(t){case"kimi":case"deepseek":case"qwen":case"chatgpt":return a.startsWith("sk-");case"doubao":return/^[a-zA-Z0-9-_]+$/.test(a);case"wenxinyiyan":return/^[a-zA-Z0-9-_/.=]+$/.test(a);case"gemini":return a.startsWith("AIzaSy");case"gork":return a.startsWith("xai-");case"zhipu":return/^[a-zA-Z0-9-_.]+$/.test(a);default:return!0}},c=(t,a)=>{if(!a){localStorage.removeItem(t);return}const s=btoa(a);localStorage.setItem(t,s)},Pe=()=>{try{b(!0),f(null),setTimeout(()=>{let t=!0,a="";if(d.id==="kimi"?(S?u("kimi",S)?c("KIMI_API_KEY",S):(t=!1,a="Kimi 密钥格式不正确，应为 sk- 开头"):c("KIMI_API_KEY",""),x(s=>({...s,kimi_base_url:Z,kimi_model:U}))):d.id==="deepseek"?(C?u("deepseek",C)?c("DEEPSEEK_API_KEY",C):(t=!1,a="DeepSeek 密钥格式不正确，应为 sk- 开头"):c("DEEPSEEK_API_KEY",""),x(s=>({...s,deepseek_base_url:Q,deepseek_model:X}))):d.id==="doubao"?(K?u("doubao",K)?c("DOUBAO_API_KEY",K):(t=!1,a="豆包 密钥格式不正确"):c("DOUBAO_API_KEY",""),x(s=>({...s,doubao_base_url:ee,doubao_model:ae}))):d.id==="wenxinyiyan"?(P?u("wenxinyiyan",P)?c("WENXIN_API_KEY",P):(t=!1,a="文心一言 密钥格式不正确"):c("WENXIN_API_KEY",""),x(s=>({...s,wenxin_base_url:re,wenxin_model:ne}))):d.id==="qwen"?(A?u("qwen",A)?c("QWEN_API_KEY",A):(t=!1,a="通义千问 密钥格式不正确，应为 sk- 开头"):c("QWEN_API_KEY",""),x(s=>({...s,qwen_base_url:de,qwen_model:ce}))):d.id==="chatgpt"?(Y?u("chatgpt",Y)?c("CHATGPT_API_KEY",Y):(t=!1,a="ChatGPT 密钥格式不正确，应为 sk- 开头"):c("CHATGPT_API_KEY",""),x(s=>({...s,chatgpt_base_url:xe,chatgpt_model:ue}))):d.id==="gemini"?(D?u("gemini",D)?c("GEMINI_API_KEY",D):(t=!1,a="Gemini 密钥格式不正确"):c("GEMINI_API_KEY",""),x(s=>({...s,gemini_base_url:he,gemini_model:ye}))):d.id==="gork"?(q?u("gork",q)?c("GORK_API_KEY",q):(t=!1,a="Gork 密钥格式不正确，应为 xai- 开头"):c("GORK_API_KEY",""),x(s=>({...s,gork_base_url:fe,gork_model:Ne}))):d.id==="zhipu"&&(R?u("zhipu",R)?c("ZHIPU_API_KEY",R):(t=!1,a="智谱 密钥格式不正确"):c("ZHIPU_API_KEY",""),x(s=>({...s,zhipu_base_url:we,zhipu_model:Ie}))),!t){f(a),b(!1);return}m.setCurrentModel(d.id),m.setCurrentRole(p.id),m.updateConfig(n),_.success("模型和角色设置已保存"),k(),b(!1)},500)}catch{f("保存模型设置失败，请稍后再试"),b(!1)}},Ae=async()=>{try{b(!0),f(null),m.setCurrentModel(d.id),m.updateConfig({stream:!1});let t;const a=s=>{s.detail.modelId===d.id&&s.detail.status==="error"&&(t=s.detail.error)};window.addEventListener("llm-connection-status-changed",a),await m.generateResponse("ping"),window.removeEventListener("llm-connection-status-changed",a),m.getConnectionStatus(d.id)==="connected"?_.success("连接正常"):_.error(`连接失败: ${t||"未知错误"}`)}catch(t){const a=t instanceof Error?t.message:String(t);_.error(`连接失败: ${a}`)}finally{b(!1)}};return w?e.jsx(y.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:`fixed inset-0 z-50 flex items-center justify-center ${r?"bg-gray-900 bg-opacity-80":"bg-gray-50 bg-opacity-80"} backdrop-blur-sm`,children:e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:`rounded-2xl ${r?"bg-gray-800":"bg-white"} shadow-xl max-w-md w-full mx-4 overflow-hidden flex flex-col`,children:[e.jsxs("div",{className:`p-6 border-b ${r?"border-gray-700":"border-gray-200"} flex justify-between items-center`,children:[e.jsx("h3",{className:"text-xl font-bold",children:"模型选择"}),e.jsx("button",{onClick:k,className:`p-2 rounded-full ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"} transition-colors`,"aria-label":"关闭",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:[M&&e.jsxs("div",{className:"mb-4 p-3 rounded-lg bg-red-100 text-red-600 text-sm flex items-center",children:[e.jsx("i",{className:"fas fa-exclamation-circle mr-2"}),M]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"font-medium",children:"选择大语言模型"}),e.jsx("button",{type:"button",onClick:Ee,className:`px-3 py-1 rounded-full text-xs font-medium transition-all ${j?"bg-purple-100 text-purple-600 dark:bg-purple-900/30 dark:text-purple-400 border border-purple-300 dark:border-purple-700":"bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600"}`,children:j?"单模型模式":"多模型模式"})]}),j?e.jsxs("div",{"aria-label":"模型列表",className:"space-y-3",children:[N.map(t=>e.jsxs(y.button,{type:"button","aria-checked":h.includes(t.id),tabIndex:0,className:`relative w-full text-left p-4 rounded-xl border transition-all ${h.includes(t.id)?"border-purple-600 bg-purple-100 dark:bg-purple-900/20 ring-2 ring-purple-500 shadow-md":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,whileHover:{y:-2},onClick:()=>Se(t.id),"aria-label":`选择模型 ${t.name}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`font-bold ${h.includes(t.id)?"text-purple-600":""}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${r?"text-gray-400":"text-gray-600"}`,children:t.description})]}),e.jsx("div",{className:`w-5 h-5 rounded border-2 transition-all ${h.includes(t.id)?"border-purple-600 bg-purple-600":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,children:h.includes(t.id)&&e.jsx("i",{className:"fas fa-check text-white text-xs flex items-center justify-center w-full h-full"})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:t.strengths.map((a,s)=>e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r?"bg-gray-700":"bg-gray-100"}`,children:a},s))})]},t.id)),e.jsxs("div",{className:"mt-3 p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("i",{className:"fas fa-info-circle mr-2"}),"已选择 ",h.length," 个模型"]}),e.jsxs("div",{className:"flex items-center justify-center text-xs ${isDark ? 'text-gray-400' : 'text-gray-600'}",children:[e.jsx("i",{className:"fas fa-chevron-down mr-2"}),"向下查看更多设置"]})]}):e.jsxs("div",{role:"radiogroup","aria-label":"模型列表",className:"space-y-3",children:[N.map((t,a)=>e.jsxs(y.button,{type:"button",role:"radio","aria-checked":d.id===t.id,tabIndex:0,className:`relative w-full text-left p-4 rounded-xl border transition-all ${d.id===t.id?"border-red-600 bg-red-100 dark:bg-red-900/20 ring-2 ring-red-500 shadow-md":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,whileHover:{y:-2},onClick:()=>v(t.id),onKeyDown:s=>Ke(s,a),"aria-label":`选择模型 ${t.name}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`font-bold ${d.id===t.id?"text-red-600":""}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${r?"text-gray-400":"text-gray-600"}`,children:t.description})]}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${d.id===t.id?"border-red-600":r?"border-gray-600":"border-gray-300"} flex items-center justify-center`,children:d.id===t.id&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"})})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:t.strengths.map((s,g)=>e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r?"bg-gray-700":"bg-gray-100"}`,children:s},g))}),d.id===t.id&&e.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-red-600 text-white",children:"已选择"})]},t.id)),e.jsxs("div",{className:"mt-3 flex items-center justify-center text-xs ${isDark ? 'text-gray-400' : 'text-gray-600'}",children:[e.jsx("i",{className:"fas fa-chevron-down mr-2"}),"向下查看更多设置"]})]})]}),e.jsxs("div",{className:"mb-6",ref:$,children:[e.jsx("h4",{className:"font-medium mb-4",children:"选择角色"}),e.jsx("div",{role:"radiogroup","aria-label":"角色列表",className:"space-y-3",children:G.map(t=>{var a;return e.jsxs(y.button,{type:"button",role:"radio","aria-checked":p.id===t.id,tabIndex:0,className:`relative w-full text-left p-4 rounded-xl border transition-all ${p.id===t.id?"border-blue-600 bg-blue-100 dark:bg-blue-900/20 ring-2 ring-blue-500 shadow-md":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"}`,whileHover:{y:-2},onClick:()=>Ce(t.id),"aria-label":`选择角色 ${t.name}`,children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h5",{className:`font-bold ${p.id===t.id?"text-blue-600":""}`,children:t.name}),e.jsx("p",{className:`text-sm mt-1 ${r?"text-gray-400":"text-gray-600"}`,children:t.description}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:(a=t.tags)==null?void 0:a.map((s,g)=>e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${r?"bg-gray-700":"bg-gray-100"}`,children:s},g))})]}),e.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${p.id===t.id?"border-blue-600":r?"border-gray-700 hover:border-gray-600":"border-gray-200 hover:border-gray-300"} flex items-center justify-center`,children:p.id===t.id&&e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"})})]}),p.id===t.id&&e.jsx("span",{className:"absolute top-3 right-3 text-xs px-2 py-1 rounded-full bg-blue-600 text-white",children:"已选择"})]},t.id)})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>W(!I),className:`flex items-center justify-between w-full p-3 rounded-xl text-left transition-all ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:[e.jsx("span",{className:"font-medium",children:"高级设置"}),e.jsx("i",{className:`fas fa-chevron-${I?"up":"down"} transition-transform duration-300`})]}),I&&e.jsxs(y.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"创作自由度 (Temperature)"}),e.jsx("span",{className:"text-sm",children:n.temperature.toFixed(1)})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:n.temperature,onChange:t=>o("temperature",parseFloat(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"严谨"}),e.jsx("span",{children:"平衡"}),e.jsx("span",{children:"创意"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型输出的随机性和创造性。值越低，输出越严谨一致；值越高，输出越多样化和创造性。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"多样性 (Top P)"}),e.jsx("span",{className:"text-sm",children:n.top_p.toFixed(1)})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:n.top_p,onChange:t=>o("top_p",parseFloat(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"集中"}),e.jsx("span",{children:"适中"}),e.jsx("span",{children:"多样"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型输出的多样性。值越低，模型只考虑最可能的输出；值越高，模型会考虑更多可能的输出，增加多样性。"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsx("label",{className:"text-sm font-medium",children:"系统提示词"})}),e.jsx("textarea",{value:n.system_prompt,onChange:t=>o("system_prompt",t.target.value),className:`w-full p-3 rounded-lg border ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,rows:3,disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"定义模型的角色和行为，指导模型在对话中的表现。系统提示词会影响模型的整体输出风格和内容方向。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"上下文历史条数"}),e.jsx("span",{className:"text-sm",children:n.max_history})]}),e.jsx("input",{type:"range",min:"1",max:"50",step:"1",value:n.max_history,onChange:t=>o("max_history",parseInt(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型在生成回复时参考的历史对话条数。值越大，模型能记住更多上下文，但可能增加响应时间和 token 消耗。"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用流式输出"}),e.jsx("input",{type:"checkbox",checked:n.stream,onChange:t=>o("stream",t.target.checked),disabled:i})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"启用后，模型会实时返回生成的内容，而不是等待完整生成后一次性返回，提供更好的交互体验。"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"最大响应长度"}),e.jsx("span",{className:"text-sm",children:n.max_tokens})]}),e.jsx("input",{type:"range",min:"500",max:"5000",step:"500",value:n.max_tokens,onChange:t=>o("max_tokens",parseInt(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"短"}),e.jsx("span",{children:"中"}),e.jsx("span",{children:"长"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型生成回复的最大长度，单位为 token。值越大，生成的内容可能越长，但响应时间也会增加。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"响应超时 (秒)"}),e.jsx("span",{className:"text-sm",children:Math.round(n.timeout/1e3)})]}),e.jsx("input",{type:"range",min:"5",max:"60",step:"5",value:Math.round(n.timeout/1e3),onChange:t=>o("timeout",parseInt(t.target.value)*1e3),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"快"}),e.jsx("span",{children:"标准"}),e.jsx("span",{children:"慢"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置模型生成回复的最大等待时间。值过小可能导致频繁超时，值过大可能让用户等待时间过长。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"新主题权重 (Presence Penalty)"}),e.jsx("span",{className:"text-sm",children:n.presence_penalty.toFixed(1)})]}),e.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:n.presence_penalty,onChange:t=>o("presence_penalty",parseFloat(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"抑制新主题"}),e.jsx("span",{children:"平衡"}),e.jsx("span",{children:"鼓励新主题"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型引入新主题的倾向。正值鼓励模型讨论新主题，负值抑制模型引入新主题。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"重复内容惩罚 (Frequency Penalty)"}),e.jsx("span",{className:"text-sm",children:n.frequency_penalty.toFixed(1)})]}),e.jsx("input",{type:"range",min:"-2",max:"2",step:"0.1",value:n.frequency_penalty,onChange:t=>o("frequency_penalty",parseFloat(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{children:"允许重复"}),e.jsx("span",{children:"平衡"}),e.jsx("span",{children:"抑制重复"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型重复使用相同词语的倾向。正值惩罚重复内容，负值鼓励重复内容。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"重试次数"}),e.jsx("span",{className:"text-sm",children:n.retry})]}),e.jsx("input",{type:"range",min:"0",max:"5",step:"1",value:n.retry,onChange:t=>o("retry",parseInt(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置模型请求失败时的自动重试次数。值越大，重试机会越多，但总等待时间可能越长。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"退避时间 (ms)"}),e.jsx("span",{className:"text-sm",children:n.backoff_ms})]}),e.jsx("input",{type:"range",min:"0",max:"2000",step:"100",value:n.backoff_ms,onChange:t=>o("backoff_ms",parseInt(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置重试之间的等待时间，采用指数退避策略。值越大，重试间隔越长，降低服务器压力。"})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[e.jsx("h5",{className:"text-sm font-medium mb-3",children:"对话记忆配置"}),e.jsx("p",{className:`text-xs mb-3 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型如何记住和使用对话历史，影响模型的上下文理解能力。"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用对话记忆"}),e.jsx("input",{type:"checkbox",checked:n.enable_memory,onChange:t=>o("enable_memory",t.target.checked),disabled:i})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"记忆窗口大小"}),e.jsx("span",{className:"text-sm",children:n.memory_window})]}),e.jsx("input",{type:"range",min:"5",max:"50",step:"5",value:n.memory_window,onChange:t=>o("memory_window",parseInt(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i||!n.enable_memory}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型保留的对话轮数，影响模型的长期记忆能力。"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"上下文窗口大小"}),e.jsx("span",{className:"text-sm",children:n.context_window})]}),e.jsx("input",{type:"range",min:"2048",max:"128000",step:"2048",value:n.context_window,onChange:t=>o("context_window",parseInt(t.target.value)),className:"w-full h-2 rounded-lg appearance-none cursor-pointer bg-gray-200 dark:bg-gray-700",disabled:i}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"控制模型能处理的最大上下文长度，单位为 token。值越大，模型能理解更长的对话内容。"})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[e.jsx("h5",{className:"text-sm font-medium mb-3",children:"多模态配置"}),e.jsx("p",{className:`text-xs mb-3 ${r?"text-gray-400":"text-gray-500"}`,children:"配置模型处理图像等多媒体内容的能力，适用于支持多模态的模型。"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用多模态支持"}),e.jsx("input",{type:"checkbox",checked:n.enable_multimodal,onChange:t=>o("enable_multimodal",t.target.checked),disabled:i})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"图像分辨率"}),e.jsx("span",{className:"text-sm",children:n.image_resolution})]}),e.jsxs("select",{value:n.image_resolution,onChange:t=>o("image_resolution",t.target.value),className:`w-full px-3 py-2 rounded-lg border ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,disabled:i||!n.enable_multimodal,children:[e.jsx("option",{value:"512x512",children:"512x512"}),e.jsx("option",{value:"1024x1024",children:"1024x1024"}),e.jsx("option",{value:"2048x2048",children:"2048x2048"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置图像输入的分辨率，影响图像理解的细节和处理速度。"})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 border-gray-200 dark:border-gray-700",children:[e.jsx("h5",{className:"text-sm font-medium mb-3",children:"安全配置"}),e.jsx("p",{className:`text-xs mb-3 ${r?"text-gray-400":"text-gray-500"}`,children:"配置模型的安全检查机制，过滤不安全或违规内容。"}),e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("label",{className:"text-sm font-medium",children:"启用安全检查"}),e.jsx("input",{type:"checkbox",checked:n.enable_safety_check,onChange:t=>o("enable_safety_check",t.target.checked),disabled:i})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"安全级别"}),e.jsx("span",{className:"text-sm",children:n.safety_level})]}),e.jsxs("select",{value:n.safety_level,onChange:t=>o("safety_level",t.target.value),className:`w-full px-3 py-2 rounded-lg border ${r?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,disabled:i||!n.enable_safety_check,children:[e.jsx("option",{value:"low",children:"低"}),e.jsx("option",{value:"medium",children:"中"}),e.jsx("option",{value:"high",children:"高"})]}),e.jsx("p",{className:`text-xs mt-2 ${r?"text-gray-400":"text-gray-500"}`,children:"设置安全检查的严格程度： - 低：较少过滤，允许更多内容 - 中：平衡过滤，兼顾安全和自由表达 - 高：严格过滤，确保内容安全"})]})]})]})]})]}),e.jsxs("div",{className:`p-6 border-t ${r?"border-gray-700":"border-gray-200"} flex justify-between items-center space-x-3`,children:[e.jsxs("span",{className:`text-sm ${r?"text-gray-400":"text-gray-600"}`,children:["当前模型：",d.name]}),e.jsx("button",{onClick:()=>{const t=m.getConfig();x({...t,temperature:.7,top_p:.9,max_tokens:2e3,timeout:3e4,system_prompt:"你是一个帮助创作者进行设计构思与文化融合的助手。",max_history:10,stream:!1,kimi_model:"moonshot-v1-32k",kimi_base_url:"https://api.moonshot.cn/v1",retry:2,backoff_ms:800,deepseek_model:"deepseek-chat",deepseek_base_url:"https://api.deepseek.com",doubao_model:"doubao-pro-32k",doubao_base_url:"https://api.doubao.com/v1",wenxin_model:"ERNIE-Speed-8K",wenxin_base_url:"https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions",qwen_model:"qwen-plus",qwen_base_url:"https://dashscope.aliyuncs.com/api/v1",chatgpt_model:"gpt-4o",chatgpt_base_url:"https://api.openai.com/v1",gemini_model:"gemini-1.5-flash",gemini_base_url:"https://generativelanguage.googleapis.com/v1",gork_model:"grok-beta",gork_base_url:"https://api.x.ai/v1",zhipu_model:"glm-4-plus",zhipu_base_url:"https://open.bigmodel.cn/api/paas/v4"}),B("https://api.moonshot.cn/v1"),L("moonshot-v1-32k"),V("https://api.deepseek.com"),J("deepseek-chat"),te("https://api.doubao.com/v1"),se("doubao-pro-32k"),le("https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions"),ie("ERNIE-Speed-8K"),oe("https://dashscope.aliyuncs.com/api/v1"),me("qwen-plus"),ge("https://api.openai.com/v1"),pe("gpt-4o"),be("https://generativelanguage.googleapis.com/v1"),je("gemini-1.5-flash"),ve("https://api.x.ai/v1"),_e("grok-beta"),ke("https://open.bigmodel.cn/api/paas/v4"),$e("glm-4-plus")},className:`px-5 py-2.5 rounded-lg transition-colors ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:"恢复默认"}),e.jsx("button",{onClick:Ae,className:`px-5 py-2.5 rounded-lg transition-colors ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:"连接测试"}),e.jsx("button",{onClick:k,className:`px-5 py-2.5 rounded-lg transition-colors ${r?"bg-gray-700 hover:bg-gray-600":"bg-gray-100 hover:bg-gray-200"}`,disabled:i,children:"取消"}),e.jsx("button",{onClick:Pe,className:`px-5 py-2.5 rounded-lg transition-colors ${i?"bg-gray-500 cursor-not-allowed":"bg-red-600 hover:bg-red-700 text-white"}`,disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-spinner fa-spin mr-2"}),"保存中..."]}):"保存设置"})]})]})}):null};export{Be as L};
